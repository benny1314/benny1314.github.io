<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Benny" />



<meta name="description" content="java8 基础知识">
<meta property="og:type" content="article">
<meta property="og:title" content="java8">
<meta property="og:url" content="/2016/09/07/160805_lambda/index.html">
<meta property="og:site_name" content="Benny">
<meta property="og:description" content="java8 基础知识">
<meta property="og:image" content="http://ww3.sinaimg.cn/large/610dc034jw1f6aipo68yvj20qo0qoaee.jpg">
<meta property="og:image" content="http://7xjlkb.com1.z0.glb.clouddn.com/learning_lambda.png">
<meta property="og:image" content="http://img01.taobaocdn.com/imgextra/i1/90219132/T2mBXnXQhXXXXXXXXX_!!90219132.jpg">
<meta property="og:updated_time" content="2016-09-14T09:32:23.961Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="java8">
<meta name="twitter:description" content="java8 基础知识">
<meta name="twitter:image" content="http://ww3.sinaimg.cn/large/610dc034jw1f6aipo68yvj20qo0qoaee.jpg">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Benny" type="application/atom+xml">



    <link rel="shortcut icon" href="http://file.ipadown.com/uploads/mjh/r3cqsmmw1pa.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>java8 | Benny</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>





    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?cefc2b6ee3fc7b9bc86d0adb0741f5d7";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>


</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="http://file.ipadown.com/uploads/mjh/r3cqsmmw1pa.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Benny</a></h1>
        </hgroup>

        
        <p class="header-subtitle">Coding is my life</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:xiaoc1314@163.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/YAML/">YAML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaweb/">javaweb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda/">lambda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plantUML/">plantUML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码整洁/">代码整洁</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具类，类库/">工具类，类库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/框架/">框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板/">模板</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/测试/">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程/">编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程工具/">编程工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/配置文件/">配置文件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/集合/">集合</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Coding is my life</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Benny</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="http://file.ipadown.com/uploads/mjh/r3cqsmmw1pa.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Benny</a></h1>
            </hgroup>
            
            <p class="header-subtitle">Coding is my life</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:xiaoc1314@163.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-160805_lambda" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/07/160805_lambda/" class="article-date">
      <time datetime="2016-09-07T01:50:27.000Z" itemprop="datePublished">2016-09-07</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      java8
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/java/">java</a><a class="article-category-link" href="/categories/java/lambda/">lambda</a><a class="article-category-link" href="/categories/java/lambda/java8/">java8</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/lambda/">lambda</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="java8-基础知识"><a href="#java8-基础知识" class="headerlink" title="java8 基础知识"></a>java8 基础知识</h1><p><img src="http://ww3.sinaimg.cn/large/610dc034jw1f6aipo68yvj20qo0qoaee.jpg" alt="image"></p>
<a id="more"></a>
<h2 id="java8-Lambda表达式"><a href="#java8-Lambda表达式" class="headerlink" title="java8 Lambda表达式"></a>java8 Lambda表达式</h2><h3 id="从苹果List中找出红颜色的苹果"><a href="#从苹果List中找出红颜色的苹果" class="headerlink" title="从苹果List中找出红颜色的苹果"></a>从苹果List中找出红颜色的苹果</h3><ul>
<li>定义一个Bean类<code>Apple.java</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> String color;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> weight;</div><div class="line"></div><div class="line">   <span class="comment">// 省略 getter 和 setter</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Apple</span><span class="params">(String color,<span class="keyword">int</span> weight)</span> </span>&#123; <span class="keyword">this</span>.color = color; <span class="keyword">this</span>.weight = weight; &#125;</div><div class="line"></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="title">Apple</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"苹果的颜色是："</span>+color + <span class="string">"苹果的重量是："</span> + weight;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>定义一个接口<code>AppleService.java</code>，里面包含一个过滤红色苹果的方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppleService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function">List&lt;Apple&gt; <span class="title">filterRedApple</span><span class="params">(List&lt;Apple&gt; list)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>实现方法<code>AppleServiceImpl.java</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppleServiceImpl</span> <span class="keyword">implements</span> <span class="title">AppleService</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Apple&gt; <span class="title">filterRedApple</span><span class="params">(List&lt;Apple&gt; list)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (Apple apple : list) &#123;</div><div class="line">            <span class="keyword">if</span> (apple.getColor().equals(<span class="string">"red"</span>)) &#123;</div><div class="line">                apples.add(apple);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> apples;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>测试：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestApple</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; list;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        String colors[] = &#123;<span class="string">"green"</span>, <span class="string">"red"</span>&#125;;</div><div class="line">        Apple apple = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (String color : colors) &#123;</div><div class="line">            apple = <span class="keyword">new</span> Apple();</div><div class="line">            apple.setColor(colors[i]);</div><div class="line">            apple.setWeight(<span class="keyword">new</span> Random().nextInt(<span class="number">100</span>));</div><div class="line">            list.add(apple);</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        System.out.println(list.size());</div><div class="line">        <span class="keyword">new</span> AppleServiceImpl().filterRedApple(list);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 上面这段代码在优化一下</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestApple</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; list;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        List&lt;Apple&gt; apples = Arrays.asList(<span class="keyword">new</span> Apple(<span class="string">"green"</span>,<span class="number">65</span>), <span class="keyword">new</span> Apple(<span class="string">"red"</span>,<span class="number">50</span>));</div><div class="line">        Apple apple = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Apple a : apples) &#123;</div><div class="line">            apple = <span class="keyword">new</span> Apple();</div><div class="line">            apple.setColor(a.getColor());</div><div class="line">            apple.setWeight(a.getWeight());</div><div class="line">            list.add(apple);</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        System.out.println(list.size());</div><div class="line">        <span class="keyword">new</span> AppleServiceImpl().filterRedApple(list);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 输出结果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">苹果的颜色是：red</div></pre></td></tr></table></figure>
<h3 id="此时如果增加新的需求要过滤绿色怎么办"><a href="#此时如果增加新的需求要过滤绿色怎么办" class="headerlink" title="此时如果增加新的需求要过滤绿色怎么办"></a>此时如果增加新的需求要过滤绿色怎么办</h3><ul>
<li>如果此时增加需求要过滤绿色的苹果，怎么办?<ul>
<li>可能会在AppleService中在增加一个方法 </li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppleService</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 过滤红色的苹果</div><div class="line">     * <span class="doctag">@param</span> list</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function">List&lt;Apple&gt; <span class="title">filterRedApple</span><span class="params">(List&lt;Apple&gt; list)</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 过滤绿色的苹果</div><div class="line">     * <span class="doctag">@param</span> list</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function">List&lt;Apple&gt; <span class="title">filterGreenApple</span><span class="params">(List&lt;Apple&gt; list)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>这样就造成了代码的冗余</p>
</blockquote>
<h3 id="使用接口Predicate"><a href="#使用接口Predicate" class="headerlink" title="使用接口Predicate"></a>使用接口Predicate</h3><ul>
<li>这个类在 <strong>java.util.function.Predicate</strong>  单独写出来为了清晰</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Predicate</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">test</span><span class="params">(T t)</span></span>;</div></pre></td></tr></table></figure>
<ul>
<li><p>你也可以单独定义一个接口，重新定义其中的方法名，使其清晰一点。</p>
</li>
<li><p>定义一个接口 <code>Predicate.java</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Predicatet</span>&lt;<span class="title">T</span>&gt;</span>&#123;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">boolean</span> <span class="title">filterApple</span><span class="params">(T t)</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>修改AppleService中的方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppleServiceImpl</span> <span class="keyword">implements</span> <span class="title">AppleService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Apple&gt; <span class="title">filterApple</span><span class="params">(List&lt;Apple&gt; list,Predicatet&lt;Apple&gt; predicatet)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> ArrayList&lt;Apple&gt;();</div><div class="line">        <span class="keyword">for</span> (Apple apple : list) &#123;</div><div class="line">            <span class="keyword">if</span> (predicatet.filterApple(apple)) &#123;</div><div class="line">                apples.add(apple);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> apples;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>测试类：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestApple</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; list;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        List&lt;Apple&gt; apples = Arrays.asList(<span class="keyword">new</span> Apple(<span class="string">"green"</span>), <span class="keyword">new</span> Apple(<span class="string">"red"</span>));</div><div class="line">        Apple apple = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Apple a : apples) &#123;</div><div class="line">            apple = <span class="keyword">new</span> Apple();</div><div class="line">            apple.setColor(a.getColor());</div><div class="line">            list.add(apple);</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">	<span class="comment">/**</span></div><div class="line">     * 过了红色的苹果</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, <span class="keyword">new</span> Predicatet&lt;Apple&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filterApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span> (<span class="string">"red"</span>.equals(apple.getColor())) &#123;		① 此处代码提取出来</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 过了绿色的苹果</div><div class="line">     */</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, <span class="keyword">new</span> Predicatet&lt;Apple&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filterApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span> (<span class="string">"green"</span>.equals(apple.getColor())) &#123;		① 此处代码提取出来</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>优化一下：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestA</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; list;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        list = <span class="keyword">new</span> ArrayList&lt;Apple&gt;();</div><div class="line">        List&lt;Apple&gt; apples = Arrays.asList(<span class="keyword">new</span> Apple(<span class="string">"green"</span>), <span class="keyword">new</span> Apple(<span class="string">"red"</span>));</div><div class="line">        Apple apple = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (Apple a : apples) &#123;</div><div class="line">            apple = <span class="keyword">new</span> Apple();</div><div class="line">            apple.setColor(a.getColor());</div><div class="line">            list.add(apple);</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">	<span class="comment">/**</span></div><div class="line">     * 过了红色的苹果</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, <span class="keyword">new</span> Predicatet&lt;Apple&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filterApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span> (isRedApple(apple)) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 过了绿色的苹果</div><div class="line">     */</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, <span class="keyword">new</span> Predicatet&lt;Apple&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filterApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span> (isGreenApple(apple))&#123;&#125;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isRedApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"red"</span>.equals(apple.getColor());</div><div class="line">    &#125;</div><div class="line"></div><div class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isGreenApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"red"</span>.equals(apple.getColor());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="使用大招-Lamda表达式-重构之前的方法-以过滤红苹果示例："><a href="#使用大招-Lamda表达式-重构之前的方法-以过滤红苹果示例：" class="headerlink" title="使用大招 Lamda表达式 重构之前的方法,以过滤红苹果示例："></a>使用大招 Lamda表达式 重构之前的方法,以过滤红苹果示例：</h3><ul>
<li>重构之前：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">    * 过了红色的苹果</div><div class="line">    */</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">       List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, <span class="keyword">new</span> Predicatet&lt;Apple&gt;() &#123;</div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filterApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">               <span class="keyword">if</span> (isRedApple(apple)) &#123;</div><div class="line">                   <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">               &#125;</div><div class="line">               <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">           &#125;</div><div class="line">       &#125;);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 重构之后：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">     * 过了红色的苹果</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, <span class="keyword">new</span> Predicatet&lt;Apple&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filterApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> isRedApple(apple));</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 再重构之后</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">      <span class="keyword">new</span> AppleServiceImpl().filterApple(list, apple -&gt; &#123;</div><div class="line">          <span class="keyword">if</span> (isRedApple(apple)) &#123;</div><div class="line">              <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">          &#125;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">      &#125;);</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 再重构之后：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, apple -&gt; &#123;</div><div class="line">        <span class="keyword">return</span> isRedApple(apple);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 再重构之后：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">       List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, apple -&gt; isRedApple(apple));</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 再重构之后：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;								  </div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, TestApple :: isRedApple);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>注意： ★★★★★★</p>
<blockquote>
<p>上面代码中：<strong>TestApple</strong> 代表的是当前类的名字。</p>
</blockquote>
<p>概念介绍：<strong>谓词</strong><br>上面的代码传递了方法<code>TestApple :: isReApple</code>(它接受参数apple并返回一个boolean值)给filterApple，后者则希望接受一个<code>Predicate&lt;Apple&gt;</code>参数。<br><strong>谓词(predicate)</strong>：<br>在数学上尝尝用来表示一个类似函数的东西，它接受一个参数值，并返回true或false,在后面你会看到，java8也会允许你写<code>Function&lt;Apple,Boolean&gt;</code>，但是用Predicate<apple>是更标准的方式，效率也会高一点，避免了boolean封装在Boolean装箱的过程。<br>简单点说谓词（就是一个返回boolean值的函数）</apple></p>
</blockquote>
<hr>
<ul>
<li>完整版示例代码：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilteringApples</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String ... args)</span></span>&#123;</div><div class="line"></div><div class="line">        List&lt;Apple&gt; inventory = Arrays.asList(<span class="keyword">new</span> Apple(<span class="number">80</span>,<span class="string">"green"</span>),</div><div class="line">                                              <span class="keyword">new</span> Apple(<span class="number">155</span>, <span class="string">"green"</span>),</div><div class="line">                                              <span class="keyword">new</span> Apple(<span class="number">120</span>, <span class="string">"red"</span>));	</div><div class="line"></div><div class="line">        <span class="comment">// [Apple&#123;color='green', weight=80&#125;, Apple&#123;color='green', weight=155&#125;]</span></div><div class="line">        List&lt;Apple&gt; greenApples = filterApples(inventory, FilteringApples::isGreenApple);</div><div class="line">        System.out.println(greenApples);</div><div class="line">        </div><div class="line">        <span class="comment">// [Apple&#123;color='green', weight=155&#125;]</span></div><div class="line">        List&lt;Apple&gt; heavyApples = filterApples(inventory, FilteringApples::isHeavyApple);</div><div class="line">        System.out.println(heavyApples);</div><div class="line">        </div><div class="line">        <span class="comment">// [Apple&#123;color='green', weight=80&#125;, Apple&#123;color='green', weight=155&#125;]</span></div><div class="line">        List&lt;Apple&gt; greenApples2 = filterApples(inventory, (Apple a) -&gt; <span class="string">"green"</span>.equals(a.getColor()));</div><div class="line">        System.out.println(greenApples2);</div><div class="line">        </div><div class="line">        <span class="comment">// [Apple&#123;color='green', weight=155&#125;]</span></div><div class="line">        List&lt;Apple&gt; heavyApples2 = filterApples(inventory, (Apple a) -&gt; a.getWeight() &gt; <span class="number">150</span>);</div><div class="line">        System.out.println(heavyApples2);</div><div class="line">        </div><div class="line">        <span class="comment">// []</span></div><div class="line">        List&lt;Apple&gt; weirdApples = filterApples(inventory, (Apple a) -&gt; a.getWeight() &lt; <span class="number">80</span> || </div><div class="line">                                                                       <span class="string">"brown"</span>.equals(a.getColor()));</div><div class="line">        System.out.println(weirdApples);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; <span class="title">filterGreenApples</span><span class="params">(List&lt;Apple&gt; inventory)</span></span>&#123;</div><div class="line">        List&lt;Apple&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (Apple apple: inventory)&#123;</div><div class="line">            <span class="keyword">if</span> (<span class="string">"green"</span>.equals(apple.getColor())) &#123;</div><div class="line">                result.add(apple);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; <span class="title">filterHeavyApples</span><span class="params">(List&lt;Apple&gt; inventory)</span></span>&#123;</div><div class="line">        List&lt;Apple&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (Apple apple: inventory)&#123;</div><div class="line">            <span class="keyword">if</span> (apple.getWeight() &gt; <span class="number">150</span>) &#123;</div><div class="line">                result.add(apple);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isGreenApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"green"</span>.equals(apple.getColor()); </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isHeavyApple</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> apple.getWeight() &gt; <span class="number">150</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; <span class="title">filterApples</span><span class="params">(List&lt;Apple&gt; inventory, Predicate&lt;Apple&gt; p)</span></span>&#123;</div><div class="line">        List&lt;Apple&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span>(Apple apple : inventory)&#123;</div><div class="line">            <span class="keyword">if</span>(p.test(apple))&#123;</div><div class="line">                result.add(apple);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;       </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> weight = <span class="number">0</span>;</div><div class="line">        <span class="keyword">private</span> String color = <span class="string">""</span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Apple</span><span class="params">(<span class="keyword">int</span> weight, String color)</span></span>&#123;</div><div class="line">            <span class="keyword">this</span>.weight = weight;</div><div class="line">            <span class="keyword">this</span>.color = color;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">getWeight</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> weight;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWeight</span><span class="params">(Integer weight)</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.weight = weight;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getColor</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> color;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setColor</span><span class="params">(String color)</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.color = color;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"Apple&#123;"</span> +</div><div class="line">                   <span class="string">"color='"</span> + color + <span class="string">'\''</span> +</div><div class="line">                   <span class="string">", weight="</span> + weight +</div><div class="line">                   <span class="string">'&#125;'</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="从方法传递到-lambda"><a href="#从方法传递到-lambda" class="headerlink" title="从方法传递到 lambda"></a>从方法传递到 lambda</h3><ul>
<li>把方法作为值来传递显然很有用，但要是为了类似于<code>isRedApple()</code>和<code>isGreenApple()</code>这种只用一两次的短方法写一堆的定义有点烦人。</li>
<li>所以在java8引入了一套新记法（匿名函数或者lambda），你可以这样写</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String... args)</span> </span>&#123;</div><div class="line">        <span class="keyword">new</span> AppleServiceImpl().filterApple(list, (Apple apple) -&gt; <span class="string">"red"</span>.equals(apple.getColor()));</div><div class="line">&#125;</div><div class="line"></div><div class="line">`</div></pre></td></tr></table></figure>
<ul>
<li>[x] 或者</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String... args)</span> </span>&#123;</div><div class="line">        <span class="keyword">new</span> AppleServiceImpl().filterApple(list, (Apple apple) -&gt;a.getWeight() &gt; <span class="number">150</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 再或者</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String... args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, (Apple apple) -&gt; <span class="string">"red"</span>.equals(apple.getColor()) || apple.getWeight() &gt; <span class="number">10</span>);</div><div class="line">        System.out.println(apples.size());</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<ul>
<li>所以你甚至不需要为只用一次的方法写定义；</li>
<li>代码更干净，更清晰</li>
<li>因为你用不着去找自己到底传递了什么代码。</li>
</ul>
<hr>
<ul>
<li>但是如果Lambda的长度多以几行（它的行为也不是一目了然）的话，你还是应该用方法引用来指向一个有描述性名称的方法，而不是使用匿名的Lambda。</li>
<li>应该以代码的清晰度为准绳</li>
</ul>
<blockquote>
<p>本来java加上filter和几个相关的东西作为通用库方法就足以让人满意了。</p>
</blockquote>
<ul>
<li>比如：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">static</span> &lt;T&gt; <span class="function">Collection&lt;T&gt; <span class="title">filter</span><span class="params">( CollectionM&lt;T&gt; c , Predicate&lt;T&gt; )</span></span>;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 这样你甚至都不需要写<strong>filterApple(List<apple> list,Predicatet<apple> predicatet)</apple></apple></strong>了</li>
</ul>
<ul>
<li>比如</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;Apple&gt; apples = <span class="keyword">new</span> AppleServiceImpl().filterApple(list, (Apple apple) -&gt; <span class="string">"red"</span>.equals(apple.getColor()));</div></pre></td></tr></table></figure>
<ul>
<li>[x] 直接使用调用库方法<strong>filter</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;Apple&gt; greenApples2 = filter(inventory, <span class="keyword">new</span> AppleColorPredicate());</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ApplePredicate</span></span>&#123;</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(Apple a)</span></span>;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<ul>
<li>但是为了更好地利用并行，java的设计师没有这么做。java8中有一整套新的集合API——Stream，他有一套函数式类似于filter的操作。<ul>
<li>比如 map、reduce 还有接下来要学习的Collections和Streams之间做转换的方法。</li>
</ul>
</li>
</ul>
<h3 id="流"><a href="#流" class="headerlink" title="流"></a>流</h3><ul>
<li>先简单的让你体验一下Stream和Lambda表达式顺序或并行地从一个列表里筛选红颜色的苹果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestApple</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; list;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        list = <span class="keyword">new</span> ArrayList&lt;Apple&gt;();</div><div class="line">        String colors[] = &#123;<span class="string">"green"</span>, <span class="string">"red"</span>&#125;;</div><div class="line">        Apple apple = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (String color : colors) &#123;</div><div class="line">            apple = <span class="keyword">new</span> Apple();</div><div class="line">            apple.setColor(colors[i]);</div><div class="line">            apple.setWeight(<span class="keyword">new</span> Random().nextInt(<span class="number">100</span>));</div><div class="line">            list.add(apple);</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; red = list.stream().filter((Apple a) -&gt; a.getColor().equals(<span class="string">"red"</span>)).collect(Collectors.toList());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>做了几个简单的测试</li>
<li>stream()比在数据量低于百万的时候 效率第一倍</li>
</ul>
<h3 id="集合的操作更加的人性化"><a href="#集合的操作更加的人性化" class="headerlink" title="集合的操作更加的人性化"></a>集合的操作更加的人性化</h3><ul>
<li>jdk1.8之前，我们对集合的一些操作比如，排序，在之前，我们使用排序</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Collections.sort(appleList, <span class="keyword">new</span> Comparator&lt;Apple&gt;() &#123;</div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Apple o1, Apple o2)</span> </span>&#123;</div><div class="line">               <span class="keyword">return</span> o1.getWeight() - o2.getWeight();</div><div class="line">           &#125;</div><div class="line">       &#125;);</div></pre></td></tr></table></figure>
<ul>
<li>[x] 在1.8之后，我们可以 <strong>集合 . sort()</strong> 示例：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">appleList.sort(<span class="keyword">new</span> Comparator&lt;Apple&gt;() &#123;</div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Apple o1, Apple o2)</span> </span>&#123;</div><div class="line">               <span class="keyword">return</span> o1.getWeight() - o2.getWeight();</div><div class="line">           &#125;</div><div class="line">       &#125;);</div></pre></td></tr></table></figure>
<ul>
<li>[x] 请出神器 Lambda 示例：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">appleList.sort((o1, o2) -&gt; o1.getWeight() - o2.getWeight());</div></pre></td></tr></table></figure>
<h3 id="默认方法"><a href="#默认方法" class="headerlink" title="默认方法"></a>默认方法</h3><ul>
<li>在java8里，你可以直接对List调用sort方法</li>
<li>它使用java8 List接口中如下所示的默认方法实现的，它会调用Collections.sort静态的方法。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">sort</span> <span class="params">(Comparator&lt;? <span class="keyword">super</span> E&gt; c)</span></span>&#123;</div><div class="line">	Coolections.sort(<span class="keyword">this</span>,c);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="第2章-通过行为参数化传递代码"><a href="#第2章-通过行为参数化传递代码" class="headerlink" title="第2章 通过行为参数化传递代码"></a>第2章 通过行为参数化传递代码</h2><h3 id="重构你的垃圾代码"><a href="#重构你的垃圾代码" class="headerlink" title="重构你的垃圾代码"></a>重构你的垃圾代码</h3><ul>
<li>定义一个谓词方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Predicatet</span>&lt;<span class="title">T</span>&gt;</span>&#123;</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">test</span><span class="params">(T t)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>在列中定义一个公共的静态的泛型方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PredicateService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">filter</span><span class="params">(List&lt;T&gt; list, Predicatet&lt;T&gt; predicatet)</span> </span>&#123;</div><div class="line">        List&lt;T&gt; result = <span class="keyword">new</span> ArrayList&lt;T&gt;();</div><div class="line">        <span class="keyword">for</span> (T t : list) &#123;</div><div class="line">            <span class="keyword">if</span> (predicatet.test(t)) &#123;</div><div class="line">                result.add(t);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>[x] 测试类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestApple</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String... args)</span> </span>&#123;</div><div class="line"> 		PredicateService.filter(list, <span class="keyword">new</span> Predicatet&lt;Apple&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">                    <span class="keyword">return</span> apple.getWeight() &gt; <span class="number">19</span>;</div><div class="line">                &#125;</div><div class="line">         &#125;);</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>此时如果</p>
<ul>
<li>[x] 使用Lambda表达式</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 过滤苹果重量&gt;19的</span></div><div class="line">List&lt;Apple&gt; filter = PredicateService.filter(list, (Apple apple) -&gt; apple.getWeight() &gt; <span class="number">19</span>);</div><div class="line"></div><div class="line"><span class="comment">// 此时如果橘子也要过滤重量&gt;19的</span></div><div class="line">List&lt;Orange&gt; filter = PredicateService.filter(list, (Orange orange) -&gt; orange.getWeight() &gt; <span class="number">19</span>);</div><div class="line"></div><div class="line"><span class="comment">// 此时就非常的方便拓展了</span></div></pre></td></tr></table></figure>
<h3 id="用Runnable-执行代码块"><a href="#用Runnable-执行代码块" class="headerlink" title="用Runnable 执行代码块"></a>用Runnable 执行代码块</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"hello world"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;).start();</div></pre></td></tr></table></figure>
<ul>
<li>[x] Lambda 重构后</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">new</span> Thread(() -&gt; System.out.println(<span class="string">"hello"</span>)).start();</div></pre></td></tr></table></figure>
<blockquote>
<p>这里要说明的，像<code>run()</code>方法一样，方法没有参数，那么书写Lamda表达式的时候，写一对<strong> 空括号() </strong></p>
</blockquote>
<h2 id="第3章-Lambda-表达式"><a href="#第3章-Lambda-表达式" class="headerlink" title="第3章 Lambda 表达式"></a>第3章 Lambda 表达式</h2><blockquote>
<p>Lambda 表达式理解为简洁地表示可传递的匿名函数的一种方式：它没有名称，但它有参数列表、函数主体、返回类型，可能还有一个可以抛出的异常列表。</p>
</blockquote>
<ul>
<li><strong>匿名</strong>:<ul>
<li>说其匿名，因为它不像普通的方法那样有一个明确的名称：写得少而想得多</li>
</ul>
</li>
<li><strong>函数</strong><ul>
<li>说其实函数，是因为Lambda函数不像方法那样属于某个特定的类，但和方法一样，lambda有参数列表、函数主体、返回类型、还可能有可以抛出的异常列表</li>
</ul>
</li>
<li><strong>传递</strong><ul>
<li>Lambda表达式可以作为参数传递给方法或存储在变量中</li>
</ul>
</li>
<li><strong>简洁</strong><ul>
<li>无需像匿名类那样写很多模板代码</li>
</ul>
</li>
</ul>
<p><img src="http://7xjlkb.com1.z0.glb.clouddn.com/learning_lambda.png" alt="Lambda表达式构成"></p>
<h3 id="详解-Lambda-表达式"><a href="#详解-Lambda-表达式" class="headerlink" title="详解 Lambda 表达式"></a>详解 Lambda 表达式</h3><ul>
<li>Lambda 没有return语句 ，因为已经隐含了return</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">(String s ) -&gt; s.length()</div></pre></td></tr></table></figure>
<ul>
<li>Lambda表达式可以包含多行语句，用一对大括号包裹</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">(<span class="keyword">int</span> x ,  <span class="keyword">int</span> y )  -&gt; &#123;</div><div class="line">	System.out.println(<span class="string">"hello"</span>);</div><div class="line">    System.out.println(<span class="string">"world"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>如果return是一个控制流语句，要让Lambda有效，需要添加花括号<code>{}</code>包裹</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">( Integer i ) -&gt; &#123; <span class="keyword">return</span> <span class="string">"benny"</span> + i;&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Lambda 没有参数，并返回String作为表达式,这种情况下不能有<code>{}</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">( ) -&gt; <span class="string">"benny"</span></div></pre></td></tr></table></figure>
<h3 id="java中有效的表达式"><a href="#java中有效的表达式" class="headerlink" title="java中有效的表达式"></a>java中有效的表达式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">(String s) -&gt; s.length()</div><div class="line"></div><div class="line">(Apple apple) -&gt; apple.getWeight() &gt; <span class="number">10</span></div><div class="line"></div><div class="line">(<span class="keyword">int</span> x ,  <span class="keyword">int</span> y )  -&gt; &#123;</div><div class="line">	System.out.println(<span class="string">"hello"</span>);</div><div class="line">    System.out.println(<span class="string">"world"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">() -&gt; <span class="number">42</span></div><div class="line"></div><div class="line">(Apple apple1, Apple apple2) -&gt; apple1.getWeight().compareTo(apple2.getWeight())</div><div class="line"></div><div class="line">( Integer i ) -&gt; &#123; <span class="keyword">return</span> <span class="string">"Alan"</span> + i &#125;</div></pre></td></tr></table></figure>
<h3 id="函数式接口"><a href="#函数式接口" class="headerlink" title="函数式接口"></a>函数式接口</h3><ul>
<li>我们之前声明的<code>Predicate&lt;T&gt;</code>接口就是一个函数式接口<ul>
<li>因为Predicate仅仅定义了一个抽象方法</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">pubilc <span class="class"><span class="keyword">interface</span> <span class="title">Predicate</span>&lt;<span class="title">T</span>&gt;</span>&#123;</div><div class="line">	</div><div class="line">    <span class="function">Boolean <span class="title">test</span><span class="params">( T t )</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>简单点说，函数式接口就是只定义<strong>一个</strong>抽象方法的接口。</li>
<li>在java API中有很多函数式接口，例如<code>Comparator</code>和<code>Runnable</code>接口</li>
</ul>
<blockquote>
<p>接口可以拥有默认方法，不管接口中有多少默认方法，只要接口中<strong>只定义了一个抽象方法（有且仅有一个）</strong>，它就是一个函数式接口，重载的方法也不行哦。</p>
</blockquote>
<ul>
<li>如果你声明了一个函数式接口，用什么办法检查你是否声明的正确呢。</li>
<li>使用<strong>@FunctionalInterface</strong> 注解（新版的API才有）</li>
</ul>
<blockquote>
<p>如果你声明了一个函数式接口，而它却不是函数式接口，编译器将返回一个提示原因的错误。</p>
</blockquote>
<ul>
<li>例如：错误提示可能是：<ul>
<li>Multiple non-overriding abstract methods found in interface Foo， 表名存在多个抽象方法。</li>
<li><strong>@FunctionalInterface</strong> 并不是必须的，但是对于设计函数式接口是比较好的做法。</li>
<li>它就像是@Override标注表示方法被重写了一样。</li>
</ul>
</li>
<li>看到这里 你可能还是不清楚为什么要要定义函数式接口（仅含有一个抽象方法的接口），因为，你定义多个方法，lambda无法确定是哪一个方法。</li>
</ul>
<h4 id="附录2：Java8中常用的函数式接口："><a href="#附录2：Java8中常用的函数式接口：" class="headerlink" title="附录2：Java8中常用的函数式接口："></a>附录2：Java8中常用的函数式接口：</h4><table>
<thead>
<tr>
<th>函数式接口</th>
<th>函数描述符</th>
<th>原始烈性特化</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Predicate&lt;T&gt;</code></td>
<td>T -&gt; boolean</td>
<td><code>IntPredicate&lt;T&gt;, LongPredicate&lt;T&gt;, DoublePredicate&lt;T&gt;</code></td>
</tr>
<tr>
<td><code>Consumer&lt;T&gt;</code></td>
<td>T -&gt; void</td>
<td><code>IntConsumer, LongConsumer, DoubleConsumer</code></td>
</tr>
<tr>
<td><code>Function&lt;T,R&gt;</code></td>
<td>T -&gt; R</td>
<td><code>IntFunction&lt;R&gt;, IntToDoubleFunction, IntToLongFunction, LongFunction&lt;R&gt;, LongToDoubleFunction, LongToIntFunction, DoubleFunction&lt;R&gt;, ToIntFunction&lt;T&gt;, ToDoubleFunction&lt;T&gt;, ToLongFunction&lt;T&gt;</code></td>
</tr>
<tr>
<td><code>Supplier&lt;T&gt;</code></td>
<td>() -&gt; T</td>
<td><code>BooleanSupplier, BooleanSupplier, BooleanSupplier, BooleanSupplier</code></td>
</tr>
<tr>
<td><code>UnaryOperator&lt;T&gt;</code></td>
<td>T -&gt; T</td>
<td><code>IntUnaryOperator, DoubleUnaryOperator, LongUnaryOperator</code></td>
</tr>
<tr>
<td><code>BinaryOperator&lt;T&gt;</code></td>
<td>(T,T) -&gt; T</td>
<td><code>IntBinaryOperator, DoubleBinaryOperator, LongBinaryOperator</code></td>
</tr>
<tr>
<td><code>BiPredicate&lt;L,R&gt;</code></td>
<td>(L,R) -&gt; boolean</td>
</tr>
<tr>
<td><code>BiConsumer&lt;T,U&gt;</code></td>
<td>(T,U) -&gt; void</td>
<td><code>ObjIntConsumer&lt;T&gt;, ObjLongConsumer&lt;T&gt;, ObjDoubleConsumer&lt;T&gt;</code></td>
</tr>
<tr>
<td><code>BiFunction&lt;T,U,R&gt;</code></td>
<td>(T,U) -&gt; R</td>
<td><code>ToIntBiFunction&lt;T,U&gt;, ToLongBiFunction&lt;T,U&gt;, ToDoubleBiFunction&lt;T,U&gt;</code></td>
</tr>
</tbody>
</table>
<h3 id="函数描述符"><a href="#函数描述符" class="headerlink" title="函数描述符"></a>函数描述符</h3><ul>
<li>函数式接口的抽象方法的签名基本就是Lambda表达式的签名，我们将这种抽象方法叫作函数描述符。</li>
</ul>
<h3 id="把Lambda-付诸实践，环绕执行模式"><a href="#把Lambda-付诸实践，环绕执行模式" class="headerlink" title="把Lambda 付诸实践，环绕执行模式"></a>把Lambda 付诸实践，环绕执行模式</h3><ul>
<li>第一步：记得行为参数化<ul>
<li>方法传参传递行为（也就是方法）</li>
</ul>
</li>
<li>第二步： 使用函数式接口来传递行为</li>
<li>第三步：执行一个行为<ul>
<li>Lambda 表达式允许你直接内联系</li>
<li>再次阐述一下流程</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">①：新建一个函数式接口  例：</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BufferReaderProcess</span> </span>&#123;</div><div class="line">    <span class="function">String <span class="title">process</span><span class="params">(BufferedReader bufferedReader)</span> <span class="keyword">throws</span> IOException</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">②：在Service中定义一个抽象方法</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FileService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function">String <span class="title">processFile</span><span class="params">(BufferReaderProcess b)</span></span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">③：实现FileReadService接口</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileServiceImpl</span> <span class="keyword">implements</span> <span class="title">FileService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">processFile</span><span class="params">(BufferReaderProcess b)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        <span class="keyword">try</span> (BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">"data.txt"</span>))) &#123;</div><div class="line">            <span class="keyword">return</span> b.process(br);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">④ ：测试</div><div class="line"></div><div class="line">String s = <span class="keyword">new</span> FileServiceImpl().processFile(<span class="keyword">new</span> BufferReaderProcess() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">process</span><span class="params">(BufferedReader bufferedReader)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        <span class="keyword">return</span> bufferedReader.readLine() + bufferedReader.readLine();</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">⑤：使用Lambda</div><div class="line"></div><div class="line">String s = <span class="keyword">new</span> FileServiceImpl().processFile((BufferedReader buffer) -&gt; buffer.readLine());</div></pre></td></tr></table></figure>
<blockquote>
<p>以上四个步骤就是应用环绕执行模式所采取的四个步骤</p>
</blockquote>
<h3 id="使用函数式接口"><a href="#使用函数式接口" class="headerlink" title="使用函数式接口"></a>使用函数式接口</h3><ul>
<li>函数式接口<br>  +<strong> 函数式接口只定义了一个抽象方法（有且仅有一个）</strong></li>
<li>java8设计师在<code>java.util.function</code>包中引入了几个新的函数式接口。</li>
</ul>
<h4 id="Predicate（谓词）"><a href="#Predicate（谓词）" class="headerlink" title="Predicate（谓词）"></a>Predicate（谓词）</h4><ul>
<li><code>java.util.function.Predicate&lt;T&gt;</code>接口定义了一个叫 <strong>test()</strong>的抽象方法，它接受泛型<code>&lt;T&gt;</code>对象，并返回一个<strong>boolean</strong>  。</li>
<li>在你需要表示一个涉及类型<code>&lt;T&gt;</code>的布尔表达式时，你就可以使用此接口。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">FunctionalInterface 	<span class="comment">// 此注解表示当前接口是一个函数式接口</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Predicate</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">test</span><span class="params">(T t)</span></span>;</div><div class="line"></div><div class="line"><span class="comment">// 接口可以拥有默认方法，不管接口中有多少默认方法，只要接口中只定义了一个抽象方法（有且仅有一个），它就是一个函数式接口</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">default</span> Predicate&lt;T&gt; <span class="title">and</span><span class="params">(Predicate&lt;? <span class="keyword">super</span> T&gt; other)</span> </span>&#123;</div><div class="line">        Objects.requireNonNull(other);</div><div class="line">        <span class="keyword">return</span> (t) -&gt; test(t) &amp;&amp; other.test(t);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">default</span> Predicate&lt;T&gt; <span class="title">negate</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (t) -&gt; !test(t);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">default</span> Predicate&lt;T&gt; <span class="title">or</span><span class="params">(Predicate&lt;? <span class="keyword">super</span> T&gt; other)</span> </span>&#123;</div><div class="line">        Objects.requireNonNull(other);</div><div class="line">        <span class="keyword">return</span> (t) -&gt; test(t) || other.test(t);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &lt;T&gt; <span class="function">Predicate&lt;T&gt; <span class="title">isEqual</span><span class="params">(Object targetRef)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">null</span> == targetRef)</div><div class="line">                ? Objects::isNull</div><div class="line">                : object -&gt; targetRef.equals(object);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>使用javaApi自带的Predicate函数式接口，代码示例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPredicate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">filter</span><span class="params">(List&lt;T&gt; list, Predicate&lt;T&gt; predicate)</span> </span>&#123;</div><div class="line">        List&lt;T&gt; result = <span class="keyword">new</span> ArrayList&lt;T&gt;();</div><div class="line">        <span class="keyword">for</span> (T t : list) &#123;</div><div class="line">            <span class="keyword">if</span> (predicate.test(t)) &#123;</div><div class="line">                result.add(t);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">		List&lt;String&gt; result = Arrays.asList(<span class="string">"My"</span>, <span class="string">"name"</span>, <span class="string">"is"</span>,<span class="string">"benny"</span>);</div><div class="line">        List&lt;String&gt; benny = filter(result, <span class="keyword">new</span> Predicate&lt;String&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> s.equals(<span class="string">"benny"</span>);</div><div class="line">            &#125;</div><div class="line">    	&#125;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">    <span class="comment">// 使用Lambda 表达式</span></div><div class="line"></div><div class="line">    <span class="comment">// 一步一步来</span></div><div class="line">    Predicate&lt;String&gt; predicate = (String str) -&gt; str.equals(<span class="string">"benny"</span>);</div><div class="line">    List&lt;String&gt; benny = filter(result, predicate);</div><div class="line">	<span class="comment">// 一步到位</span></div><div class="line">    List&lt;String&gt; benny1 = filter(result, (String str) -&gt; str.equals(<span class="string">"benny"</span>));</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Consumer（消费者）"><a href="#Consumer（消费者）" class="headerlink" title="Consumer（消费者）"></a>Consumer（消费者）</h4><ul>
<li><code>java.util.function.Consumer&lt;T&gt;</code>定义了一个<strong>accept</strong>的抽象方法它接受泛型<code>&lt;T&gt;</code>的对象，没有返回值 <strong>void</strong>。</li>
<li>在你需要访问类型<code>&lt;T&gt;</code>的对象，并对其执行某些操作，就可以使用此接口 。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">@FunctionalInterface</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Consumer</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(T t)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">default</span> Consumer&lt;T&gt; <span class="title">andThen</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> T&gt; after)</span> </span>&#123;</div><div class="line">        Objects.requireNonNull(after);</div><div class="line">        <span class="keyword">return</span> (T t) -&gt; &#123; accept(t); after.accept(t); &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>使用javaApi自带的Consumer函数式接口，代码示例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/*  foreach(result, new Consumer&lt;String&gt;() &#123;</span></div><div class="line">           @Override</div><div class="line">           public void accept(String s) &#123;</div><div class="line">               System.out.print(s+"\t");</div><div class="line">           &#125;</div><div class="line">       &#125;);*/</div><div class="line"></div><div class="line">	<span class="comment">// 使用Lambda 表达式</span></div><div class="line"> 		<span class="comment">// 一步一步来</span></div><div class="line">       Consumer&lt;String&gt; consumer = (String s) -&gt; System.out.print(s + <span class="string">"\t"</span>);</div><div class="line">       foreach(result, consumer);</div><div class="line">		 <span class="comment">// 一步到位</span></div><div class="line">       foreach(result, (String s) -&gt; System.out.print(s + <span class="string">"\t"</span>));</div></pre></td></tr></table></figure>
<h4 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h4><ul>
<li><code>java.util.function.Function&lt;T,R&gt;</code>接口定义了一个<strong>apply</strong>的抽象方法它接受泛型<code>&lt;T&gt;</code>的对象，它接受一个泛型<code>&lt;T&gt;</code>的对象，并返回一个泛型<code>&lt;R&gt;</code>的对象。</li>
<li>如果你需要定义一个Lambda,将输入的对象的信息映射到输出，就可以使用这个接口 。<ul>
<li>比如你传入一个 <code>List&lt;String&gt;</code> 返回一个 <code>List&lt;integer&gt;</code></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">@FunctionalInterface</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Function</span>&lt;<span class="title">T</span>, <span class="title">R</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function">R <span class="title">apply</span><span class="params">(T t)</span></span>;</div><div class="line"></div><div class="line">    <span class="keyword">default</span> &lt;V&gt; <span class="function">Function&lt;V, R&gt; <span class="title">compose</span><span class="params">(Function&lt;? <span class="keyword">super</span> V, ? extends T&gt; before)</span> </span>&#123;</div><div class="line">        Objects.requireNonNull(before);</div><div class="line">        <span class="keyword">return</span> (V v) -&gt; apply(before.apply(v));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">default</span> &lt;V&gt; <span class="function">Function&lt;T, V&gt; <span class="title">andThen</span><span class="params">(Function&lt;? <span class="keyword">super</span> R, ? extends V&gt; after)</span> </span>&#123;</div><div class="line">        Objects.requireNonNull(after);</div><div class="line">        <span class="keyword">return</span> (T t) -&gt; after.apply(apply(t));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &lt;T&gt; <span class="function">Function&lt;T, T&gt; <span class="title">identity</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> t -&gt; t;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>使用javaApi自带的Function函数式接口，代码示例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFunction</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T, R&gt; <span class="function">List&lt;R&gt; <span class="title">map</span><span class="params">(List&lt;T&gt; list, Function&lt;T, R&gt; function)</span> </span>&#123;</div><div class="line">        List&lt;R&gt; result = <span class="keyword">new</span> ArrayList&lt;R&gt;();</div><div class="line">        <span class="keyword">for</span> (T t : list) &#123;</div><div class="line">            result.add(function.apply(t));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line"></div><div class="line">        List&lt;String&gt; result = Arrays.asList(<span class="string">"My"</span>, <span class="string">"name"</span>, <span class="string">"is"</span>,<span class="string">"benny"</span>);</div><div class="line">    	<span class="comment">// 使用Lambda 表达式</span></div><div class="line">    	<span class="comment">// 一步一步来</span></div><div class="line">        List&lt;Integer&gt; map = map(result, <span class="keyword">new</span> Function&lt;String, Integer&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> s.length();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">		<span class="comment">// 一步到位</span></div><div class="line">        List&lt;Integer&gt; map = map(result, (String str) -&gt; str.length());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="原始类型特化"><a href="#原始类型特化" class="headerlink" title="原始类型特化"></a>原始类型特化</h3><ul>
<li>java类型有两种<ul>
<li>引用类型</li>
<li>基本数据类型</li>
</ul>
</li>
<li>基本数据类型转换成引用类型，是装箱的过程。</li>
<li>装箱的本质<ul>
<li>将基本数据类型包裹起来，并保存在堆里。</li>
<li>因此装箱后的值需要更多的内存，并需要额外的内存搜索来获取被包裹的原始值。</li>
</ul>
</li>
</ul>
<blockquote>
<p>java8为我们的函数式接口带来了一个专门的版本，以便在输入和输出值都是基本数据类型时避免自动装箱的操作。</p>
</blockquote>
<hr>
<blockquote>
<p>使用javaApi自带的IntPredicate函数式接口，代码示例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line"></div><div class="line">		IntPredicate intPredicate = (<span class="keyword">int</span> k) -&gt; i % <span class="number">2</span> == <span class="number">0</span>;</div><div class="line">        <span class="keyword">boolean</span> flag = intPredicate.test(<span class="number">1000</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>使用javaApi自带的IntPredicate函数式接口，代码示例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">  	IntBinaryOperator intBinaryOperator = <span class="keyword">new</span> IntBinaryOperator() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">applyAsInt</span><span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> left + right;</div><div class="line">          &#125;</div><div class="line">      &#125;;</div><div class="line">      <span class="keyword">int</span> i = intBinaryOperator.applyAsInt(<span class="number">5</span>, <span class="number">21</span>);</div><div class="line">      </div><div class="line">      <span class="comment">// 使用Lambda表达式</span></div><div class="line">IntBinaryOperator intBinaryOperator = (<span class="keyword">int</span> i, <span class="keyword">int</span> j) -&gt; i + j;</div><div class="line">      <span class="keyword">int</span> i = intBinaryOperator.applyAsInt(<span class="number">2</span>, <span class="number">3</span>);</div><div class="line">      System.out.println(i);</div></pre></td></tr></table></figure>
<blockquote>
<p>使用javaApi自带的BiFunction函数式接口，代码示例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">BiFunction&lt;String, String, String&gt; stringStringStringBiFunction = <span class="keyword">new</span> BiFunction&lt;String, String, String&gt;()&#123;</div><div class="line"></div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> String <span class="title">apply</span><span class="params">(String s, String s2)</span> </span>&#123;</div><div class="line">               <span class="keyword">return</span> s + s2;</div><div class="line">           &#125;</div><div class="line">       &#125;;</div><div class="line"></div><div class="line">	<span class="comment">// 使用Lambda表达式  </span></div><div class="line">	BiFunction&lt;String, String, String&gt; stringStringStringBiFunction = (String s, String s2) -&gt; s + s2;</div><div class="line">	String apply = stringStringStringBiFunction.apply(<span class="string">"hello"</span>, <span class="string">"world"</span>);</div></pre></td></tr></table></figure>
<blockquote>
<p>使用javaApi自带的BiFunction函数式接口，代码示例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line"></div><div class="line">	Supplier&lt;String&gt; stringSupplier = <span class="keyword">new</span> Supplier&lt;String&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">()</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="string">"hello world"</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">		String s = stringSupplier.get();</div><div class="line">        </div><div class="line">        <span class="comment">// 使用Lambda表达式  </span></div><div class="line">        Supplier&lt;String&gt; stringSupplier = () -&gt; <span class="string">"hello world"</span>;</div><div class="line">		String s = stringSupplier.get();</div><div class="line">        </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>一般来说，针对专门的输入输出参数类型的函数式接口的名称都要加上对应的原始类型前缀。<br>比如：</p>
<blockquote>
<p>DoublePredicate、IntConsumer、ingBinaryOperator，IntFunction等</p>
</blockquote>
</blockquote>
<hr>
<blockquote>
<p>Function接口还有针对输出参数类型的变种：</p>
<blockquote>
<p><code>ToIntFunction&lt;T&gt;</code>、IntToDoubleFunction等 </p>
</blockquote>
</blockquote>
<h4 id="java8常用函数式接口"><a href="#java8常用函数式接口" class="headerlink" title="java8常用函数式接口"></a>java8常用函数式接口</h4><table>
<thead>
<tr>
<th>函数式接口</th>
<th>函数描述符</th>
<th>原始烈性特化</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Predicate&lt;T&gt;</code></td>
<td>T -&gt; boolean</td>
<td><code>IntPredicate&lt;T&gt;, LongPredicate&lt;T&gt;, DoublePredicate&lt;T&gt;</code></td>
</tr>
<tr>
<td><code>Consumer&lt;T&gt;</code></td>
<td>T -&gt; void</td>
<td><code>IntConsumer, LongConsumer, DoubleConsumer</code></td>
</tr>
<tr>
<td><code>Function&lt;T,R&gt;</code></td>
<td>T -&gt; R</td>
<td><code>IntFunction&lt;R&gt;, IntToDoubleFunction, IntToLongFunction, LongFunction&lt;R&gt;, LongToDoubleFunction, LongToIntFunction, DoubleFunction&lt;R&gt;, ToIntFunction&lt;T&gt;, ToDoubleFunction&lt;T&gt;, ToLongFunction&lt;T&gt;</code></td>
</tr>
<tr>
<td><code>Supplier&lt;T&gt;</code></td>
<td>() -&gt; T</td>
<td><code>BooleanSupplier, BooleanSupplier, BooleanSupplier, BooleanSupplier</code></td>
</tr>
<tr>
<td><code>UnaryOperator&lt;T&gt;</code></td>
<td>T -&gt; T</td>
<td><code>IntUnaryOperator, DoubleUnaryOperator, LongUnaryOperator</code></td>
</tr>
<tr>
<td><code>BinaryOperator&lt;T&gt;</code></td>
<td>(T,T) -&gt; T</td>
<td><code>IntBinaryOperator, DoubleBinaryOperator, LongBinaryOperator</code></td>
</tr>
<tr>
<td><code>BiPredicate&lt;L,R&gt;</code></td>
<td>(L,R) -&gt; boolean</td>
</tr>
<tr>
<td><code>BiConsumer&lt;T,U&gt;</code></td>
<td>(T,U) -&gt; void</td>
<td><code>ObjIntConsumer&lt;T&gt;, ObjLongConsumer&lt;T&gt;, ObjDoubleConsumer&lt;T&gt;</code></td>
</tr>
<tr>
<td><code>BiFunction&lt;T,U,R&gt;</code></td>
<td>(T,U) -&gt; R</td>
<td><code>ToIntBiFunction&lt;T,U&gt;, ToLongBiFunction&lt;T,U&gt;, ToDoubleBiFunction&lt;T,U&gt;</code></td>
</tr>
</tbody>
</table>
<h4 id="附录1：Lambda及函数式接口的例子："><a href="#附录1：Lambda及函数式接口的例子：" class="headerlink" title="附录1：Lambda及函数式接口的例子："></a>附录1：Lambda及函数式接口的例子：</h4><table>
<thead>
<tr>
<th>使用案例</th>
<th>lambda例子</th>
<th>对应函数式接口</th>
</tr>
</thead>
<tbody>
<tr>
<td>布尔表达式</td>
<td>(List<string> list) -&gt; list.isEmpty()</string></td>
<td><code>Predicate&lt;List&lt;String&gt;&gt;</code></td>
</tr>
<tr>
<td>创建对象</td>
<td>() -&gt; new Fan()</td>
<td><code>Supplier&lt;Fan&gt;</code></td>
</tr>
<tr>
<td>消费一个对象void</td>
<td>(Fan f) -&gt; sys…out(f.toString)</td>
<td><code>Consumer&lt;Fan&gt;</code></td>
</tr>
<tr>
<td>从一个对象中选择提取</td>
<td>(String s) -&gt; s.length()</td>
<td><code>Function&lt;String,Integer&gt;</code> 或 <code>ToIntFunction&lt;String&gt;</code></td>
</tr>
<tr>
<td>合并2个值</td>
<td>(int a , int b) -&gt; a+b</td>
<td><code>IntBinaryOperator</code></td>
</tr>
<tr>
<td>比较2个对象</td>
<td>(Fan a , Fan b) -&gt; a.getXX().compareTo(b.getXX())</td>
<td><code>Comparator&lt;Fan&gt;</code>或 <code>BiFunction&lt;Fan,Fan,Integer&gt;</code>或 <code>ToIntBiFunction&lt;Fan.Fan&gt;</code></td>
</tr>
</tbody>
</table>
<h3 id="异常、Lambda，还有函数式接口是什么鬼"><a href="#异常、Lambda，还有函数式接口是什么鬼" class="headerlink" title="异常、Lambda，还有函数式接口是什么鬼"></a>异常、Lambda，还有函数式接口是什么鬼</h3><blockquote>
<p>注意： 任何函数式接口都不允许抛出受检异常</p>
</blockquote>
<ul>
<li>如果你需要Lambda表达式抛出异常，有两种方式：<ul>
<li>定义一个自己的函数式接口，并声明受检异常</li>
<li>将Lambda表达式包裹在一个<code>try/catch</code>块中</li>
</ul>
</li>
</ul>
<blockquote>
<p>自定义函数式接口，代码示例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">@FunctionalInterface</span></div><div class="line">pubilc <span class="class"><span class="keyword">interface</span> <span class="title">BufferedReaderPrcessor</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function">String <span class="title">process</span><span class="params">(BufferedReader br )</span> throw IOException</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">BufferedReaderProcessor p  = (BufferedReader br) -&gt; br.readLine();</div></pre></td></tr></table></figure>
<ul>
<li>但是你可能使用一个接受函数式接口的API,比如Function<t,r>，没有办法自己创建一个，在这种情况下，你可以显式的捕获受检异常</t,r></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Function&lt;BufferedReader,String&gt; f = (BufferedReader br) -&gt; &#123;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">    	<span class="keyword">return</span> br.readLine();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">catch</span>(IOException e)&#123;</div><div class="line">    	<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="类型检查-类型推断-以及限制"><a href="#类型检查-类型推断-以及限制" class="headerlink" title="类型检查 类型推断 以及限制"></a>类型检查 类型推断 以及限制</h3><h4 id="类型检查"><a href="#类型检查" class="headerlink" title="类型检查"></a>类型检查</h4><ul>
<li>类型检查过程可以分解为如下几个步骤：<ul>
<li>首先，你要找出filter方法的声明<ul>
<li><code>filter(List&lt;Apple&gt; inventory,Predicate&lt;Apple&gt; p)</code></li>
</ul>
</li>
<li>第二，要求它是<code>Predicate&lt;Apple&gt;</code>(目标类型)对象的第二个正式参数<ul>
<li><code>filter(List&lt;Apple&gt; inventroy , Predicate&lt;Apple&gt; p)</code></li>
</ul>
</li>
<li>第三，<code>Predicate&lt;Apple&gt;</code>是一个函数式接口，定义了一个叫做test的抽象方法<ul>
<li><code>boolean test(Apple apple)</code></li>
</ul>
</li>
<li>第四，test方法描述了一个函数描述符，他可以接受一个Apple，并返回一个boolean<ul>
<li><code>Apple -&gt; boolean</code></li>
</ul>
</li>
<li>最后filter的任何实际参数都必须匹配这个要求<ul>
<li><code>filter(inventory,(Apple apple) -&gt; a.getWeight()&gt;150);</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>如果Lambda表达式抛出一个异常，那么抽象方法所声明的Throws语句要必须与之匹配</p>
</blockquote>
<h4 id="类型推断"><a href="#类型推断" class="headerlink" title="类型推断"></a>类型推断</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Predicatet&lt;Apple&gt; p = (Apple a) -&gt; a.getWeight() &gt; <span class="number">11</span>;		☛ 有显式类型Apple</div><div class="line"></div><div class="line">Predicate&lt;Apple&gt; p1 = (a) -&gt; a.getWeight() &gt; <span class="number">11</span>;			☛ 没有类型推断 因为反省中已经制定类型为Apple</div><div class="line"></div><div class="line">Predicate&lt;Apple&gt; p2 = a -&gt; a.getWeight() &gt; <span class="number">11</span>;				☛</div></pre></td></tr></table></figure>
<blockquote>
<p>当Lambda表达式仅有一个类型需要推断的参数时，参数名称两边的括号也可以省略。</p>
</blockquote>
<h4 id="使用局部变量"><a href="#使用局部变量" class="headerlink" title="使用局部变量"></a>使用局部变量</h4><ul>
<li>局部变量必须显式的被声明为final</li>
</ul>
<blockquote>
<p>对局部变量的限制</p>
</blockquote>
<ul>
<li>实例变量和局部变量有一个关键不同<ul>
<li><strong>实例变量都储存在堆中</strong></li>
<li><strong>局部变量存储在栈上</strong></li>
</ul>
</li>
</ul>
<h3 id="方法引用"><a href="#方法引用" class="headerlink" title="方法引用"></a>方法引用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">inventory.sort( ( Apple a1,Apple a2 ) -&gt; a1.getWeight() .compareTo(a2.getWeight() ) );</div><div class="line"></div><div class="line">inventory.sort( comparing( Apple :: getWeight()) );</div></pre></td></tr></table></figure>
<h4 id="管中窥豹"><a href="#管中窥豹" class="headerlink" title="管中窥豹"></a>管中窥豹</h4><ul>
<li>方法引用可以被看做仅仅调用特定方法的Lambda的一种快捷写法。</li>
</ul>
<blockquote>
<p>它的基本思想：<br>如果一个Lambda代表的只是”直接调用这个方法“，那最好还是用名称来调用它，而不是去描述如何调用它。<br>方法引用就是，让你根据已有的方法实现来创建Lambda表达式。</p>
</blockquote>
<h5 id="Lambda及其等效方法引用的例子"><a href="#Lambda及其等效方法引用的例子" class="headerlink" title="Lambda及其等效方法引用的例子"></a>Lambda及其等效方法引用的例子</h5><table>
<thead>
<tr>
<th>Lambda</th>
<th>等效的方法引用</th>
</tr>
</thead>
<tbody>
<tr>
<td>( Apple a ) -&gt; a.getWeight()</td>
<td>Apple :: getWeight</td>
</tr>
<tr>
<td>() -&gt; Thread.currentThread().dumpStack()</td>
<td>Thread.currenThread() :: dumpStack</td>
</tr>
<tr>
<td>( str , i )-&gt; str.subtring(i)</td>
<td>String :: substring</td>
</tr>
<tr>
<td>( String s )-&gt; System.out.pringln(s)</td>
<td>System.sout :: println</td>
</tr>
</tbody>
</table>
<h5 id="如何构建方法引用"><a href="#如何构建方法引用" class="headerlink" title="如何构建方法引用"></a>如何构建方法引用</h5><blockquote>
<p>方法引用有三类</p>
</blockquote>
<ul>
<li>指向静态方法的方法引用<ul>
<li>例如Integer的parseInt方法，写作 <code>Integer :: parseInt</code></li>
</ul>
</li>
<li>指向任意类型示例方法的方法引用<ul>
<li>例如String的length方法，写作<code>String :: length</code></li>
</ul>
</li>
<li>指向现有对象的实例方法的方法引用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;String&gt; l = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">      </div><div class="line">      l.sort((String str, String str2) -&gt; str.compareToIgnoreCase(str2));</div><div class="line">      <span class="comment">// 方法引用</span></div><div class="line">      l.sort(String::compareToIgnoreCase);</div><div class="line"></div><div class="line">Function&lt;String, Integer&gt; stringToInteger1 = (String strs) -&gt; Integer.parseInt(strs);</div><div class="line">      <span class="comment">// 方法引用</span></div><div class="line">      Function&lt;String, Integer&gt; stringToInteger2 = Integer :: parseInt;</div><div class="line">      </div><div class="line">      BiPredicate&lt;List&lt;String&gt;,String&gt; contains = (lists, element) -&gt; list.contains(element);</div><div class="line">       <span class="comment">// 方法引用</span></div><div class="line">      BiPredicate&lt;List&lt;String&gt;, String&gt; contains2 = List::contains;</div></pre></td></tr></table></figure>
<h4 id="构造函数引用"><a href="#构造函数引用" class="headerlink" title="构造函数引用"></a>构造函数引用</h4><ul>
<li>对于一个现有的构造函数，你可以使用它的名称和它的关键字new来创建它的一个引用，<strong> ClassName :: new</strong></li>
<li><code>Supplier&lt;Apple&gt; s = Apple::new;</code></li>
<li>它的功能与指向静态方法的引用类似， 它适合Supplier的签名 <code>() -&gt; Apple</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Supplier&lt;Apple&gt; supplier = <span class="keyword">new</span> Supplier&lt;Apple&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> Apple <span class="title">get</span><span class="params">()</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> <span class="keyword">new</span> Apple();</div><div class="line">          &#125;</div><div class="line">      &#125;;</div><div class="line">      Apple apple = supplier.get();</div><div class="line">      </div><div class="line">      <span class="comment">// 使用Labmda表达式</span></div><div class="line">      Supplier&lt;Apple&gt; s = () -&gt; <span class="keyword">new</span> Apple();</div><div class="line">      Apple apple1 = s.get();</div><div class="line">      </div><div class="line">      <span class="comment">// 使用构造方法引用</span></div><div class="line">      Supplier&lt;Apple&gt; s1 = Apple::<span class="keyword">new</span>;</div><div class="line">      Apple apple2 = s1.get();</div></pre></td></tr></table></figure>
<ul>
<li>如果你的构造函数的签名是Apple(Integer weight)， 那么它就适合Function接口的签名</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Function&lt;Integer, Apple&gt; function = <span class="keyword">new</span> Function&lt;Integer, Apple&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> Apple <span class="title">apply</span><span class="params">(Integer integer)</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Apple(integer);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        Apple apple = function.apply(<span class="number">888</span>);</div><div class="line">        <span class="comment">// 等价于</span></div><div class="line">        Function&lt;Integer, Apple&gt; function1 = (Integer weight) -&gt; <span class="keyword">new</span> Apple(weight);</div><div class="line">        Apple apple1 = function1.apply(<span class="number">888</span>);</div><div class="line">        <span class="comment">// 等价于</span></div><div class="line">        Function&lt;Integer, Apple&gt; function2 = (weight) -&gt; <span class="keyword">new</span> Apple(weight);</div><div class="line">        Apple apple2 = function2.apply(<span class="number">888</span>);</div><div class="line">        <span class="comment">// 等价于</span></div><div class="line">        Function&lt;Integer, Apple&gt; function3 = weight -&gt; <span class="keyword">new</span> Apple(weight);</div><div class="line">        Apple apple3 = function3.apply(<span class="number">888</span>);</div><div class="line">        <span class="comment">// 等价于</span></div><div class="line">        Function&lt;Integer, Apple&gt; function4 = Apple::<span class="keyword">new</span>;</div><div class="line">        Apple apple4 = function4.apply(<span class="number">888</span>);</div></pre></td></tr></table></figure>
<ul>
<li>一个由Integer构成的List中的每个元素都通过我们定义的map方法传递给了Apple的构造函数，得到一个不同重量的苹果的List</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">       List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">254</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">76</span>, <span class="number">867</span>);</div><div class="line">       List&lt;Apple&gt; appleList = getAppleList(integers, (Integer i) -&gt; <span class="keyword">new</span> Apple(i));</div><div class="line">       <span class="comment">// 使用方法引用</span></div><div class="line">       List&lt;Apple&gt; appleList1 = getAppleList(integers, Apple::<span class="keyword">new</span>);</div><div class="line">&#125;</div><div class="line">   </div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; <span class="title">map</span><span class="params">(List&lt;Integer&gt; list, Function&lt;Integer, Apple&gt; function)</span> </span>&#123;</div><div class="line">       List result = <span class="keyword">new</span> ArrayList();</div><div class="line">       <span class="keyword">for</span> (Integer integer : list) &#123;</div><div class="line">           Apple apply = function.apply(integer);</div><div class="line">           result.add(apply);</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> result;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<ul>
<li>如果你有一个具有两个参数的构造函数Apple(String color , Integer weigth)，那么它就适合<strong>BiFunction</strong>接口的签名</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">BiFunction&lt;String, Integer, Apple&gt; biFunction = <span class="keyword">new</span> BiFunction&lt;String, Integer, Apple&gt;() &#123;</div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> Apple <span class="title">apply</span><span class="params">(String s, Integer integer)</span> </span>&#123;</div><div class="line">               <span class="keyword">return</span> <span class="keyword">new</span> Apple(s, integer);</div><div class="line">           &#125;</div><div class="line">       &#125;;</div><div class="line">       Apple apple = biFunction.apply(<span class="string">"red"</span>, <span class="number">888</span>);</div><div class="line"></div><div class="line">       BiFunction&lt;String, Integer, Apple&gt; biFunction1 = (String color, Integer weight) -&gt; <span class="keyword">new</span> Apple(color, weight);</div><div class="line">       Apple apple1 = biFunction1.apply(<span class="string">"green"</span>, <span class="number">888</span>);</div></pre></td></tr></table></figure>
<h3 id="Lambda和方法引用实战"><a href="#Lambda和方法引用实战" class="headerlink" title="Lambda和方法引用实战"></a>Lambda和方法引用实战</h3><h4 id="第一步：传递代码"><a href="#第一步：传递代码" class="headerlink" title="第一步：传递代码"></a>第一步：传递代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        apples.sort(<span class="keyword">new</span> AppleCompator());</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AppleCompator</span> <span class="keyword">implements</span> <span class="title">Comparator</span>&lt;<span class="title">Apple</span>&gt; </span>&#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Apple o1, Apple o2)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> o1.getColor().compareTo(o2.getColor());</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="第二步：使用匿名类"><a href="#第二步：使用匿名类" class="headerlink" title="第二步：使用匿名类"></a>第二步：使用匿名类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        List&lt;Apple&gt; apples = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        apples.sort(<span class="keyword">new</span> Comparator&lt;Apple&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Apple o1, Apple o2)</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> o1.getColor().compareTo(o2.getColor());</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="使用Lambda表达式"><a href="#使用Lambda表达式" class="headerlink" title="使用Lambda表达式"></a>使用Lambda表达式</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">       List&lt;Apple&gt; apples = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">       apples.sort(((Apple apple, Apple apple2) -&gt; apple.getColor().compareTo(apple2.getColor())));</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h4 id="使用方法引用"><a href="#使用方法引用" class="headerlink" title="使用方法引用"></a>使用方法引用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">       List&lt;Apple&gt; apples = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">       apples.sort(Comparator.comparing(Apple::getWeight));</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h3 id="复合Lambda表达式的有用方法"><a href="#复合Lambda表达式的有用方法" class="headerlink" title="复合Lambda表达式的有用方法"></a>复合Lambda表达式的有用方法</h3><h4 id="比较器复合"><a href="#比较器复合" class="headerlink" title="比较器复合"></a>比较器复合</h4><blockquote>
<p>逆序</p>
</blockquote>
<ul>
<li>比如你要对苹果的重量递减<ul>
<li><code>.reversed()</code></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">apples.sort(Comparator.comparing(Apple::getWeight).reversed());</div></pre></td></tr></table></figure>
<blockquote>
<p>比较器链</p>
</blockquote>
<ul>
<li>比如你要对苹果的重量递减，但是你发现欧两个苹果一样重怎么办，你可以在提供一个Comparator<ul>
<li><code>.thenComparing(...)</code></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">apples.sort(Comparator.comparing(Apple::getWeight)</div><div class="line">        .reversed()		<span class="comment">// 按照递减排序</span></div><div class="line">        .thenComparing(Apple::getColor));		<span class="comment">// 当苹果一样重时，按照颜色排序</span></div></pre></td></tr></table></figure>
<h4 id="谓词复合"><a href="#谓词复合" class="headerlink" title="谓词复合"></a>谓词复合</h4><ul>
<li>谓词接口包括三个方法：<ul>
<li><strong>negate</strong><ul>
<li>使用<code>negate()</code>方法返回一个谓词接口的<strong>非</strong></li>
</ul>
</li>
<li><strong>and</strong><ul>
<li>可以使用<code>and(...)</code>方法连接 Lambda 表达式</li>
</ul>
</li>
<li><strong>or</strong><ul>
<li>可以使用<code>or(...)</code>方法表达是它或是它</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Predicate&lt;Apple&gt; redApplePredicate = <span class="keyword">new</span> Predicate&lt;Apple&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(Apple apple)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> apple.getColor().equals(<span class="string">"red"</span>);</div><div class="line">          &#125;</div><div class="line">      &#125;;</div><div class="line">      </div><div class="line">      <span class="comment">// 筛选红颜色的苹果</span></div><div class="line">      Predicate&lt;Apple&gt; redApplePredicate1 = (Apple a) -&gt; a.getColor().equals(<span class="string">"red"</span>);</div><div class="line">      </div><div class="line">      <span class="comment">// 筛选不是红颜色的苹果</span></div><div class="line">      Predicate&lt;Apple&gt; notRedApplePredicate = redApplePredicate1.negate();</div><div class="line"></div><div class="line">      List&lt;Apple&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">      <span class="keyword">for</span> (Apple apple : apples) &#123;</div><div class="line">          <span class="keyword">if</span> (notRedApplePredicate.test(apple)) &#123;</div><div class="line">              list.add(apple);</div><div class="line">          &#125;</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<ul>
<li>组合谓词，表达既是红苹果又是绿苹果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 筛选红颜色的苹果</span></div><div class="line">      Predicate&lt;Apple&gt; redApplePredicate1 = (Apple a) -&gt; a.getColor().equals(<span class="string">"red"</span>);</div><div class="line">      <span class="comment">// 筛选重量大于100g的苹果</span></div><div class="line">      Predicate&lt;Apple&gt; weightApplePredicate = (Apple b) -&gt; b.getWeight() &gt; <span class="number">100</span>;</div><div class="line"><span class="comment">// 既是红苹果并且苹果大于100g </span></div><div class="line">      Predicate&lt;Apple&gt; colorAndWeightApple = redApplePredicate.and(weightApplePredicate);</div><div class="line"><span class="comment">// 等价于</span></div><div class="line">      redApplePredicate.negate().and((Apple apple) -&gt; apple.getWeight() &gt; <span class="number">150</span>);</div><div class="line"></div><div class="line">      List&lt;Apple&gt; list = <span class="keyword">new</span> ArrayList&lt;Apple&gt;();</div><div class="line">      <span class="keyword">for</span> (Apple apple : apples) &#123;</div><div class="line">          <span class="keyword">if</span> (colorAndWeightApple.test(apple)) &#123;</div><div class="line">              list.add(apple);</div><div class="line">          &#125;</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<ul>
<li>进一步组合谓词，要么是中(150g以上)的红苹果，要么是绿苹果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Predicate&lt;Apple&gt; redOrGreenApplePredicate = redApplePredicate</div><div class="line">                                           	.and(a -&gt; a.getWeight() &gt; <span class="number">150</span>)</div><div class="line">                                           	.or(a -&gt; <span class="string">"green"</span>.equals(a.getColor()));</div><div class="line">       List&lt;Apple&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">       <span class="keyword">for</span> (Apple apple : apples) &#123;</div><div class="line">           <span class="keyword">if</span> (redOrGreenApplePredicate.test(apple)) &#123;</div><div class="line">               list.add(apple);</div><div class="line">           &#125;</div><div class="line">       &#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>注意：</p>
<p><strong>and和or方法是按照在表达式链中的位置，从左到右确定优先级的。</strong><br>因此，<code>a.or(b).and(c)</code>可以看作 <code>( a || b ) &amp;&amp; c</code></p>
</blockquote>
<h4 id="函数复合"><a href="#函数复合" class="headerlink" title="函数复合"></a>函数复合</h4><ul>
<li>最后你还可以吧Function函数式接口所代表的Lambda表达式复合起来。</li>
<li>Function函数式接口为此配备了<code>andThen()</code>和<code>compose()</code>两个默认方法，他们都会返回Function的一个实例。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Function&lt;Integer, Integer&gt; times2 = e -&gt; e * <span class="number">2</span>;</div><div class="line"></div><div class="line">Function&lt;Integer, Integer&gt; squared = e -&gt; e * e; </div><div class="line"></div><div class="line">times2.compose(squared).apply(<span class="number">4</span>); </div><div class="line"><span class="comment">// Returns 32</span></div><div class="line"></div><div class="line">times2.andThen(squared).apply(<span class="number">4</span>); </div><div class="line"><span class="comment">// Returns 64</span></div></pre></td></tr></table></figure>
<ul>
<li>不知道你是否看懂了，说下这两个方法<ul>
<li><code>a.andThen( b )</code>     先执行 a，然后再执行 b</li>
<li><code>a.compose(b)</code>        先执行 b，然后再执行 a</li>
</ul>
</li>
</ul>
<blockquote>
<p><code>f.andThen(g)</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Function&lt;Integer, Integer&gt; f = x -&gt; x + <span class="number">1</span>;</div><div class="line">   Function&lt;Integer, Integer&gt; g = x -&gt; x * <span class="number">2</span>;</div><div class="line">   Function&lt;Integer, Integer&gt; h = f.andThen(g);</div><div class="line">   <span class="keyword">int</span> result = h.apply(<span class="number">1</span>);</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">输入</th>
<th style="text-align:center"></th>
<th style="text-align:center"><code>f.andthen(g)</code></th>
<th style="text-align:center"></th>
<th style="text-align:center">结果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">——f—&gt;</td>
<td style="text-align:center">2</td>
<td style="text-align:center">——g——&gt;</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">——f—&gt;</td>
<td style="text-align:center">3</td>
<td style="text-align:center">——g——&gt;</td>
<td style="text-align:center">6</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">——f—&gt;</td>
<td style="text-align:center">4</td>
<td style="text-align:center">——g——&gt;</td>
<td style="text-align:center">8</td>
</tr>
</tbody>
</table>
<blockquote>
<p><code>f.compose(g)</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Function&lt;Integer, Integer&gt; f = x -&gt; x + <span class="number">1</span>;</div><div class="line">   Function&lt;Integer, Integer&gt; g = x -&gt; x * <span class="number">2</span>;</div><div class="line">   Function&lt;Integer, Integer&gt; h = f.compose(g);</div><div class="line">   <span class="keyword">int</span> result = h.apply(<span class="number">1</span>);</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">输入</th>
<th style="text-align:center"></th>
<th style="text-align:center"><code>f.compose(g)</code></th>
<th style="text-align:center"></th>
<th style="text-align:center">结果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">——f—&gt;</td>
<td style="text-align:center">2</td>
<td style="text-align:center">——g——&gt;</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">——f—&gt;</td>
<td style="text-align:center">4</td>
<td style="text-align:center">——g——&gt;</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">——f—&gt;</td>
<td style="text-align:center">6</td>
<td style="text-align:center">——g——&gt;</td>
<td style="text-align:center">7</td>
</tr>
</tbody>
</table>
<blockquote>
<p>实际<strong>应用：</strong></p>
</blockquote>
<ul>
<li>比如你有一个工具类，用来处理文本。</li>
</ul>
<blockquote>
<p>Letter.java</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Letter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">addHeader</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"benny"</span> + text;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">addFooter</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> text + <span class="string">"by benny"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">checkSpelling</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> text.replaceAll(<span class="string">"beny"</span>, <span class="string">"benny"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line"></div><div class="line">        Function&lt;String, String&gt; addHeader = Letter::addHeader;</div><div class="line">        </div><div class="line">        Function&lt;String, String&gt; transformation = addHeader.andThen(Letter::checkSpelling).andThen(Letter::addFooter);</div><div class="line">        </div><div class="line">        String text = transformation.apply(<span class="string">"i miss beny,because i have not seen him for a long time"</span>);</div><div class="line">        System.out.println(text);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<ul>
<li>结果：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Dear:</div><div class="line"></div><div class="line">i miss benny,because i have not seen him <span class="keyword">for</span> a <span class="keyword">long</span> time</div><div class="line">                                                                by benny</div></pre></td></tr></table></figure>
<ul>
<li>只加抬头和落款，而不做拼写检查：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">      </div><div class="line">      Function&lt;String, String&gt; addHeader = Letter::addHeader;</div><div class="line"></div><div class="line">      Function&lt;String, String&gt; transformation = addHeader.andThen(Letter::addFooter);</div><div class="line">      </div><div class="line">      String text = transformation.apply(<span class="string">"i miss beny,because i have not seen him for a long time"</span>);</div><div class="line">      System.out.println(text);</div><div class="line"></div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<ul>
<li>结果：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Dear:</div><div class="line"></div><div class="line">i miss beny,because i have not seen him <span class="keyword">for</span> a <span class="keyword">long</span> time</div><div class="line">                                                                by benny</div></pre></td></tr></table></figure>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>Lambda表达式可以理解为一种匿名函数：它没有名称、但有参数列表、函数主体、返回类型，可能还有一个可以抛出的异常列表</li>
<li>Lambda表达式可以让你简洁地传递代码</li>
<li><strong>函数式接口</strong>就是仅仅声明了一个抽象方法的接口</li>
<li>只有在接受函数式接口的地方才可以使用Lambda表达式</li>
<li>只有在接受函数式接口的地方才可以使用Lambda表达式</li>
<li>Lambda表达式允许你直接内联，为函数是接口的抽象方法提供实现，并且将整个表达式作为函数式接口的一个实例</li>
<li>java8自带一些常用的函数式接口，放在<code>java.util.function</code>包里，包括<code>Predicate&lt;T&gt;</code>、<code>Function&lt;T,R&gt;</code>、<code>Supplier&lt;T&gt;</code>、<code>Consumer&lt;T&gt;</code>、和<code>BinaryOperatory&lt;T&gt;</code>，详情见函数式接口里的表。</li>
<li>为了避免装箱操作，对<code>Predicate&lt;T&gt;</code>和<code>Function&lt;T,R&gt;</code>等通用函数式接口的原始类型特化，<code>IntPredicate</code>、<code>IntToLongFunction</code>等</li>
<li>环绕执行模式（即在方法所必须的代码中间，你需要执行点什么操作，比如资源分配和清理）可以配合Lambda提高灵活性和可重用性。</li>
<li>Lambda表达式所需要代表的类型成为目标类型</li>
<li>方法引用让你重复只是用现有的方法实现并直接传递它们</li>
<li><code>Comparator</code>、<code>Predicate</code>和<code>Function</code>等函数式接口都有几个可以用来结合Lambda表达式的默认方法。</li>
</ul>
<h1 id="第二部分-函数式数据处理"><a href="#第二部分-函数式数据处理" class="headerlink" title="第二部分 函数式数据处理"></a>第二部分 函数式数据处理</h1><h2 id="第4章-引入流"><a href="#第4章-引入流" class="headerlink" title="第4章 引入流"></a>第4章 引入流</h2><h3 id="流是什么"><a href="#流是什么" class="headerlink" title="流是什么"></a>流是什么</h3><ul>
<li>流是java API的新成员，它允许你以声明性方式处理数据集合(通过查询语句表达而不是临时编写一个实现)</li>
<li>用两个例子来看下：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dish</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> vegetarian;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> calories;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Type type;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Dish</span><span class="params">(String name, <span class="keyword">boolean</span> vegetarian, <span class="keyword">int</span> calories, Type type)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">        <span class="keyword">this</span>.vegetarian = vegetarian;</div><div class="line">        <span class="keyword">this</span>.calories = calories;</div><div class="line">        <span class="keyword">this</span>.type = type;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//省略 getter 和 setter</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>java 7</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;Dish&gt; menu = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">      List&lt;Dish&gt; lowCaloricDish = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">      <span class="comment">//用累加器筛选元素</span></div><div class="line">      <span class="keyword">for</span> (Dish dish : menu) &#123;</div><div class="line">          <span class="keyword">if</span>(dish.getCalories() &lt; <span class="number">400</span>)&#123;</div><div class="line">              lowCaloricDish.add(dish);</div><div class="line">          &#125;</div><div class="line">      &#125;</div><div class="line">      <span class="comment">// 用匿名类对才要排序</span></div><div class="line">      Collections.sort(lowCaloricDish, <span class="keyword">new</span> Comparator&lt;Dish&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Dish o1, Dish o2)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> o1.getCalories() - o2.getCalories();</div><div class="line">          &#125;</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">      List&lt;String&gt; lowCaloricDishName = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">      <span class="comment">// 处理排序后的菜名列表</span></div><div class="line">      <span class="keyword">for</span> (Dish dish : lowCaloricDish) &#123;</div><div class="line">          lowCaloricDishName.add(dish.getName());</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>java8</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">menu.stream().</div><div class="line">      		filter((Dish dish) -&gt; dish.getCalories() &lt; <span class="number">400</span>)</div><div class="line">              .sorted(Comparator.comparing(Dish::getCalories))</div><div class="line">              .map(Dish::getName)</div><div class="line">            	.collect(Collectors.toList());</div></pre></td></tr></table></figure>
<ul>
<li>为了利用多核架构并行执行这段代码，你只需要吧<code>stream()</code>换成<code>parallelStream()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">menu.parallelStream()</div><div class="line">     		.filter((Dish dish) -&gt; dish.getCalories() &lt; <span class="number">400</span>)</div><div class="line">             .sorted(Comparator.comparing(Dish::getCalories))</div><div class="line">             .map(Dish::getName)</div><div class="line">             .collect(Collectors.toList());</div></pre></td></tr></table></figure>
<ul>
<li>使用java8的新方法有几个显而易见的好处<ul>
<li>代码是以声明性方式写的<ul>
<li>说明想要完成什么(筛选热量低的菜肴)，而不是说明如何实现一个操作(利用循环和if条件等控制语句)</li>
<li>这种方法加上行为参数化让你可以轻松应对变化的需求：你很容易创建一个代码版本，利用Lambda表达式筛选高卡路里的菜肴，而不用赋值粘贴代码</li>
</ul>
</li>
<li>你可以将几个基础操作链接起来，来表达复杂的数据处理流水线(filter后面接上sorted、map和collect操作)，同事保证代码清晰可读。</li>
</ul>
</li>
</ul>
<h4 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h4><ul>
<li>声明性——更简洁、更易读</li>
<li>可复合——更灵活</li>
<li>可并行——性能更好</li>
</ul>
<h3 id="流简介"><a href="#流简介" class="headerlink" title="流简介"></a>流简介</h3><h4 id="流的定义"><a href="#流的定义" class="headerlink" title="流的定义"></a>流的定义</h4><blockquote>
<p>从支持数据处理操作的源生成的元素序列</p>
</blockquote>
<ul>
<li>元素序列<ul>
<li>就像集合一样，流也提供了一个接口，可以访问特定元素类型的一组有序值。</li>
<li>集合是数据结构：<ul>
<li>它的主要目的是以特定的时间/控件复杂度存储和访问元素（如ArrayList和LinkedList）</li>
</ul>
</li>
<li>流的目的在于计算<ul>
<li>比如filter、sorted和map    </li>
</ul>
</li>
<li>集合讲的是数据，流讲的计算</li>
</ul>
</li>
<li>源<ul>
<li>流会使用一个提供数据的源，如集合、数组、或输入/输出资源</li>
<li>从有序集合生成流时会保留原有的顺序。</li>
<li>由列表生成的流，其元素顺序与列表一致</li>
</ul>
</li>
<li>数据处理操作<ul>
<li>流的数据处理功能支持类似与数据库的操作，以及函数式编程语言中的常用操作，如：filter、map、reduce、find、match、sort等。</li>
<li>流操作可以顺序执行，也可以并行</li>
</ul>
</li>
<li>流水线<ul>
<li>很多流操作本身会返回一个流，这样多个操作就可以链接起来，形成一个大的流水线</li>
<li>流的操作可以看做对数据源进行数据库式查询</li>
</ul>
</li>
<li>内部迭代<ul>
<li>与使用迭代器显式迭代的集合不同，流的迭代操作是在背后进行的。</li>
</ul>
</li>
</ul>
<h3 id="流与集合"><a href="#流与集合" class="headerlink" title="流与集合"></a>流与集合</h3><h4 id="只能遍历一次"><a href="#只能遍历一次" class="headerlink" title="只能遍历一次"></a>只能遍历一次</h4><ul>
<li>和迭代器类似，流只能遍历一次。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;String&gt; title = Arrays.asList(<span class="string">"java8"</span>, <span class="string">"by"</span>, <span class="string">"heart"</span>);</div><div class="line">      Stream&lt;String&gt; stream = title.stream();</div><div class="line">      stream.forEach(System.out::println);</div><div class="line">      stream.forEach(System.out::println);	<span class="comment">// 抛出 java.lang.IllegalStateException: 流已被操作或关闭</span></div></pre></td></tr></table></figure>
<h4 id="外部迭代与内部迭代"><a href="#外部迭代与内部迭代" class="headerlink" title="外部迭代与内部迭代"></a>外部迭代与内部迭代</h4><ul>
<li>集合：用for-each循环外部迭代</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;Dish&gt; menu = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">List&lt;String&gt; names = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">      <span class="keyword">for</span> (Dish dish : menu) &#123;</div><div class="line">          names.add(dish.getName());</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<ul>
<li>集合：用背后的迭代器做外部迭代</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;Dish&gt; menu = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">      List&lt;String&gt; names = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">      Iterator&lt;Dish&gt; iterator = menu.iterator();</div><div class="line">      <span class="keyword">while</span> (iterator.hasNext()) &#123;</div><div class="line">          Dish d = iterator.next();</div><div class="line">          names.add(d.getName());</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<ul>
<li>流内部迭代</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;String&gt; names = menu.stream()</div><div class="line">              .map(Dish::getName)		<span class="comment">// 用getName方法参数化map</span></div><div class="line">              .collect(Collectors.toList());</div></pre></td></tr></table></figure>
<h3 id="流操作"><a href="#流操作" class="headerlink" title="流操作"></a>流操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;String&gt; names = menu.stream()      <span class="comment">// 获得流</span></div><div class="line">              .filter(d -&gt; d.getCalories() &gt; <span class="number">300</span>)    <span class="comment">// 中间操作</span></div><div class="line">              .map(Dish::getName)     <span class="comment">// 中间操作</span></div><div class="line">              .limit(<span class="number">3</span>)		<span class="comment">// 中间操作</span></div><div class="line">              .collect(Collectors.toList());      <span class="comment">// 将Stream转换为List  终端操作</span></div></pre></td></tr></table></figure>
<ul>
<li>可以链接起来的流操作称为：<strong>中间操作</strong></li>
<li>关闭流的操作称为：<strong>终端操作</strong></li>
</ul>
<h4 id="中间操作"><a href="#中间操作" class="headerlink" title="中间操作"></a>中间操作</h4><ul>
<li>诸如filter和sorted等中间操作会返回另外一个<strong>流</strong>，这让多个操作可以连接起来形成一个查询。</li>
<li>中间操作不会执行任何处理，除非触发一个终端操作。</li>
</ul>
<h4 id="终端操作"><a href="#终端操作" class="headerlink" title="终端操作"></a>终端操作</h4><ul>
<li>终端操作会从流的流水线生成结果，其结果是任何<strong>不是流的值</strong>，可以使List,Integer,甚至void</li>
</ul>
<h4 id="使用流"><a href="#使用流" class="headerlink" title="使用流"></a>使用流</h4><ul>
<li>流的使用一般包括三件事：<ul>
<li>一个数据源（如集合）来执行一个查询</li>
<li>一个中间操作链，形成一条流的流水线</li>
<li>一个终端操作，执行流水线，并能生成结果</li>
</ul>
</li>
</ul>
<h5 id="中间操作-1"><a href="#中间操作-1" class="headerlink" title="中间操作"></a>中间操作</h5><table>
<thead>
<tr>
<th>操作</th>
<th>类型</th>
<th>返回类型</th>
<th>操作参数</th>
<th>函数描述符</th>
</tr>
</thead>
<tbody>
<tr>
<td>filter</td>
<td>中间</td>
<td><code>Stream&lt;T&gt;</code></td>
<td><code>Predicate&lt;T&gt;</code></td>
<td>T -&gt; boolean</td>
</tr>
<tr>
<td>map</td>
<td>中间</td>
<td><code>Stream&lt;R&gt;</code></td>
<td><code>Function&lt;T,R&gt;</code></td>
<td>T -&gt; R</td>
</tr>
<tr>
<td>limit</td>
<td>中间</td>
<td><code>Stream&lt;T&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td>sorted</td>
<td>中间</td>
<td><code>Stream&lt;T&gt;</code></td>
<td><code>Comparator&lt;T&gt;</code></td>
<td>(T,T) -&gt; int</td>
</tr>
<tr>
<td>distinct</td>
<td>中间</td>
<td><code>Stream&lt;T&gt;</code></td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="终端操作-1"><a href="#终端操作-1" class="headerlink" title="终端操作"></a>终端操作</h5><table>
<thead>
<tr>
<th>操作</th>
<th>类型</th>
<th>目的</th>
</tr>
</thead>
<tbody>
<tr>
<td>forEach</td>
<td>终端</td>
<td>消费流中的每个元素并对其应用Lambda，这一操作返回void</td>
</tr>
<tr>
<td>count</td>
<td>终端</td>
<td>返回流中元素的个数，这一操作返回long</td>
</tr>
<tr>
<td>collect</td>
<td>终端</td>
<td>把流归约承一个集合，比如List，Map甚至是Integer</td>
</tr>
</tbody>
</table>
<h3 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h3><ul>
<li>流是从支持数据处理操作的源生成的一系列元素</li>
<li>流利用内部迭代：迭代通过filter、map、sorted等操作被抽象掉了</li>
<li>流操作有两类：中间操作和终端操作</li>
<li>filter和map等中间操作会返回一个流，并可以链接在一起。可以用它们来设置一条流水线，但并不会生成任何结果</li>
<li>forEach和Count等终端操作会返回一个非流的值，并处理流水线以返回结果</li>
<li>流中的元素是按需计算的</li>
</ul>
<h2 id="第5章"><a href="#第5章" class="headerlink" title="第5章"></a>第5章</h2><h3 id="筛选和切片"><a href="#筛选和切片" class="headerlink" title="筛选和切片"></a>筛选和切片</h3><h4 id="用谓词筛选"><a href="#用谓词筛选" class="headerlink" title="用谓词筛选"></a>用谓词筛选</h4><ul>
<li>Stream接口支持filter方法，改操作会接受一个谓词（一个返回boolean的函数）作为参数，并返回一个包含所有复合谓词的元素的流。</li>
</ul>
<h4 id="筛选各异的元素"><a href="#筛选各异的元素" class="headerlink" title="筛选各异的元素"></a>筛选各异的元素</h4><ul>
<li>流还支持一个叫做distinct的方法，它会返回一个元素各异（根据流所生成元素的hashCode和equals方法实现）的流。</li>
<li>简单点说就是去重</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>);</div><div class="line">      list.stream()</div><div class="line">      		.filter(num -&gt; num % <span class="number">2</span> == <span class="number">0</span>)</div><div class="line">              .distinct()</div><div class="line">              .forEach(System.out::print);</div><div class="line"></div><div class="line">outPut: <span class="number">2</span>  <span class="number">4</span>  <span class="number">8</span></div></pre></td></tr></table></figure>
<h4 id="截断流"><a href="#截断流" class="headerlink" title="截断流"></a>截断流</h4><ul>
<li>流支持limit方法，该方法会返回一个不超过给定长度的流。所需参数作为参数传递给limit</li>
<li>如果流是有序的，则最多会返回前n个元素</li>
</ul>
<blockquote>
<p>limit也可以用在无序流上，比如源是一个Set，这种情况下，limit的结果不会以任何形式排序</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>);</div><div class="line">      list.stream().filter(num -&gt; num % <span class="number">2</span> == <span class="number">0</span>)</div><div class="line">              .distinct()</div><div class="line">              .limit(<span class="number">2</span>)</div><div class="line">              .forEach(System.out::print);</div><div class="line"></div><div class="line">      outPut： <span class="number">2</span>   <span class="number">4</span></div></pre></td></tr></table></figure>
<h4 id="跳过元素"><a href="#跳过元素" class="headerlink" title="跳过元素"></a>跳过元素</h4><ul>
<li>流还支持skip(n)方法，返回一个<strong>扔掉了前n个元素</strong>的流。</li>
<li>如果流中元素个数不足n个，则放回一个空流。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>);</div><div class="line">      list.stream().filter(num -&gt; num % <span class="number">2</span> == <span class="number">0</span>)</div><div class="line">              .distinct()</div><div class="line">              .skip(<span class="number">2</span>)</div><div class="line">              .forEach(System.out::print);</div><div class="line"></div><div class="line">outPut: <span class="number">8</span></div></pre></td></tr></table></figure>
<h3 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h3><h4 id="对流中每一个元素应用函数"><a href="#对流中每一个元素应用函数" class="headerlink" title="对流中每一个元素应用函数"></a>对流中每一个元素应用函数</h4><ul>
<li>流支持map方法，它会接受一个函数作为参数。</li>
<li>这个函数会被应用到每个元素上，并将其映射成一个新的元素（使用映射，是因为他和转换类似，但其中的细微差别在于它是“<strong>创建一个新版本</strong>”，而不是去“修改”）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">strs.stream()</div><div class="line">              .map(String::length)</div><div class="line">              .sorted()</div><div class="line">              .forEach(System.out::println);</div></pre></td></tr></table></figure>
<ul>
<li>当你不知道一个方法中的Lambda表达式应该如何写的时候，你可以这样做</li>
<li>先传入匿名内部类，然后一步一步的提炼</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">①</div><div class="line">strs.stream()</div><div class="line">	.map(<span class="keyword">new</span> Function&lt;String, Integer&gt;() &#123;</div><div class="line">              <span class="meta">@Override</span></div><div class="line">              <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">                  <span class="keyword">return</span> s.length();</div><div class="line">              &#125;</div><div class="line">          &#125;)</div><div class="line">          .sorted()</div><div class="line">          .forEach(System.out::println);</div><div class="line">②</div><div class="line">      strs.stream()</div><div class="line">      	.map((String s) -&gt; s.length())</div><div class="line">          .sorted()</div><div class="line">          .forEach(System.out::println);</div><div class="line">③</div><div class="line">strs.stream()</div><div class="line">          .map(s -&gt; s.length());</div><div class="line">          .sorted()</div><div class="line">          .forEach(System.out::println);</div><div class="line">④</div><div class="line">strs.stream()</div><div class="line">	.map(String::length)</div><div class="line">	.sorted()</div><div class="line">          .forEach(System.out::println);</div></pre></td></tr></table></figure>
<h4 id="流的扁平化"><a href="#流的扁平化" class="headerlink" title="流的扁平化"></a>流的扁平化</h4><ul>
<li>如何返回一张单词表，列出里面各不相同的字符呢。</li>
<li>第一个版本,返回的是一个list，里面包含了两个string[]数组</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; words = Arrays.asList(<span class="string">"hello"</span>, <span class="string">"world"</span>);</div><div class="line">      List&lt;String[]&gt; collect = words.stream()</div><div class="line">              .map(str -&gt; str.split(<span class="string">""</span>))</div><div class="line">              .distinct()</div><div class="line">              .collect(Collectors.toList());</div><div class="line"></div><div class="line">outPut:		[[Ljava.lang.String;@<span class="number">7</span>a79be86, [Ljava.lang.String;@<span class="number">34</span>ce8af7]</div></pre></td></tr></table></figure>
<blockquote>
<p>这与我们想要的不同，我们要的是<code>List&lt;String&gt;</code>而现在是<code>List&lt;String[]&gt;</code></p>
</blockquote>
<ul>
<li>尝试使用Map和Arrays.stream()</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">String[] word = &#123;<span class="string">"hello"</span>, <span class="string">"world"</span>&#125;;</div><div class="line">Stream&lt;String&gt; wordStream = Arrays.stream(word);</div><div class="line">List&lt;String[]&gt; collect = wordStream</div><div class="line">        .map(str -&gt; str.split(<span class="string">""</span>))</div><div class="line">        .collect(Collectors.toList());</div></pre></td></tr></table></figure>
<blockquote>
<p>依然搞不定，返回的仍然是<code>List&lt;String[]&gt;</code></p>
</blockquote>
<ul>
<li>我们可以使用<strong>flatMap</strong>来解决这个问题        ☆☆☆☆☆☆</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;String&gt; words = Arrays.asList(<span class="string">"hello"</span>, <span class="string">"world"</span>);</div><div class="line">      List&lt;String&gt; collect = words.stream()</div><div class="line">              .map(str -&gt; str.split(<span class="string">""</span>))</div><div class="line">              .flatMap(<span class="keyword">new</span> Function&lt;String[], Stream&lt;String&gt;&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> Stream&lt;String&gt; <span class="title">apply</span><span class="params">(String[] strings)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> Arrays.stream(strings);</div><div class="line">          &#125;</div><div class="line">      &#125;)</div><div class="line">              .distinct()</div><div class="line">              .collect(Collectors.toList());</div><div class="line"></div><div class="line"><span class="comment">// 使用lambda表达式</span></div><div class="line"></div><div class="line">List&lt;String&gt; words = Arrays.asList(<span class="string">"hello"</span>, <span class="string">"world"</span>);</div><div class="line">      List&lt;String&gt; collect = words.stream()</div><div class="line">              .map(str -&gt; str.split(<span class="string">""</span>))</div><div class="line">              .flatMap(Arrays::stream)</div><div class="line">              .distinct()</div><div class="line">              .collect(Collectors.toList());</div><div class="line"></div><div class="line"><span class="comment">// 另一种方式</span></div><div class="line">String[] word = &#123;<span class="string">"hello"</span>, <span class="string">"world"</span>&#125;;</div><div class="line">      Stream&lt;String&gt; wordStream = Arrays.stream(word);</div><div class="line">      List&lt;String&gt; collect = wordStream</div><div class="line">              .map(str -&gt; str.split(<span class="string">""</span>))</div><div class="line">              .flatMap(Arrays::stream)</div><div class="line">              .distinct()</div><div class="line">              .collect(Collectors.toList());</div><div class="line"></div><div class="line">outPut:		h, e, l, o, w, r, d</div></pre></td></tr></table></figure>
<ul>
<li><strong>flatMap()方法</strong></li>
<li>让你将流中的每个值都换成另一个流，然后把所有的流连接起来成为一个流</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 给定给一个数字列表，返回一个由每个数的平方构成的列表</span></div><div class="line">      List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      List&lt;Integer&gt; collect = integers.stream()</div><div class="line">              .map(n -&gt; n * n)</div><div class="line">              .collect(Collectors.toList());</div><div class="line"></div><div class="line">outPut:  <span class="number">1</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">16</span>,<span class="number">25</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 给定两个数字列表，如何返回所有的数对</span></div><div class="line">      List&lt;<span class="keyword">int</span>[]&gt; collect1 = integers1.stream().</div><div class="line">              flatMap(i -&gt; integers2.stream()</div><div class="line">                      .map(j -&gt; <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, j&#125;))</div><div class="line">              .collect(Collectors.toList());</div><div class="line"></div><div class="line">outPut:		(<span class="number">1.3</span>),(<span class="number">1</span>,<span class="number">4</span>(<span class="number">2</span>,<span class="number">3</span>)(<span class="number">2</span>,<span class="number">4</span>),(<span class="number">3</span>,<span class="number">3</span>),(<span class="number">3</span>,<span class="number">4</span>)</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 拓展上一个例子，只返回总和能被3整除的数对</span></div><div class="line">List&lt;<span class="keyword">int</span>[]&gt; collect1 = integers1.stream().</div><div class="line">              flatMap(i -&gt; integers2.stream()</div><div class="line">                      .filter(j -&gt; (i + j) % <span class="number">3</span> == <span class="number">0</span>)</div><div class="line">                      .map(j -&gt; <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, j&#125;)</div><div class="line">                      .sorted(Comparator.comparing(ints -&gt; ints[<span class="number">0</span>] - ints[<span class="number">1</span>])))</div><div class="line">              .collect(Collectors.toList());</div></pre></td></tr></table></figure>
<ul>
<li>和map类似，不同的是其每个元素转换得到的是Stream对象，会把子Stream中的元素压缩到父集合中；</li>
</ul>
<p><img src="http://img01.taobaocdn.com/imgextra/i1/90219132/T2mBXnXQhXXXXXXXXX_!!90219132.jpg" alt="借用之并发编程网"></p>
<h3 id="查找和匹配"><a href="#查找和匹配" class="headerlink" title="查找和匹配"></a>查找和匹配</h3><ul>
<li>Stream API 通过allMatch、anyMatch、noneMatch、findFirst和findAny()方法提供了这样的工具</li>
</ul>
<h4 id="检查谓词是否至少匹配一个元素"><a href="#检查谓词是否至少匹配一个元素" class="headerlink" title="检查谓词是否至少匹配一个元素"></a>检查谓词是否至少匹配一个元素</h4><ul>
<li><strong>anyMatch()方法</strong><ul>
<li>查看流中是否有一个元素能匹配给定的谓词</li>
<li>anyMatch()方法返回一个人<strong>boolean</strong></li>
<li>因为返回boolean,所以是<strong>终端操作</strong></li>
</ul>
</li>
</ul>
<blockquote>
<p>比如查看菜单中是否有素食</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">boolean</span> flag = menu.stream().anyMatch(Dish::isVegetarian);</div><div class="line">      </div><div class="line"><span class="keyword">if</span> (flag) &#123;</div><div class="line">          System.out.println(<span class="string">"the meat is vegetarian"</span>);</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<h4 id="检查谓词是否匹配所有元素"><a href="#检查谓词是否匹配所有元素" class="headerlink" title="检查谓词是否匹配所有元素"></a>检查谓词是否匹配所有元素</h4><ul>
<li><strong>allMatch()方法</strong><ul>
<li>工作原理和anyMatch()类似，但它会查看流中的元素是否都能匹配给定的谓词。</li>
</ul>
</li>
</ul>
<blockquote>
<p>查看菜品是否健康</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">boolean</span> flag = menu.stream().allMatch(d -&gt; d.getCalories() &lt; <span class="number">1000</span>);</div></pre></td></tr></table></figure>
<ul>
<li><strong>noneMatch()</strong><ul>
<li>与allMatch()相反，它可以确保流中没有任何元素与给定的谓词匹配。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">boolean</span> flag = menu.stream().allMatch(d -&gt; d.getCalories() &lt; <span class="number">1000</span>);</div></pre></td></tr></table></figure>
<ul>
<li>短路求值<ul>
<li>有些操作不需要处理整个流就能得到结果。</li>
</ul>
</li>
</ul>
<h4 id="查找元素"><a href="#查找元素" class="headerlink" title="查找元素"></a>查找元素</h4><ul>
<li><strong>findAny()方法</strong></li>
<li>返回当前流中的任意元素，它可以与其他操作结合使用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Optional&lt;Dish&gt; any = menu.stream()</div><div class="line">              .filter(Dish::isVegetarian)</div><div class="line">              .findAny();</div></pre></td></tr></table></figure>
<ul>
<li>流水线将在后台只需走一遍，并利用短路找到结果立即返回。 </li>
<li><code>Optional&lt;T&gt;</code>类是一个容器类，代表一个值存在或不存在</li>
<li>Optional里面有几种可以迫使你显式的检查值是否存在或处理值不存在的情形的方法</li>
</ul>
<table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>isPresent()</code></td>
<td>将在optional包含值的时候返回true，反之返回false</td>
</tr>
<tr>
<td><code>isPresent(Consumer&lt;T&gt; block)</code></td>
<td>会在值存在时执行给定的代码块，在第3章介绍过Consumer函数式接口，他让你传递一个接受T类型参数，并返回void的Lambda表达式</td>
</tr>
<tr>
<td><code>T get()</code></td>
<td>会在值存在时返回值，否则抛出一个NoSuchElement异常</td>
</tr>
<tr>
<td><code>T orElse(T other)</code></td>
<td>会在值存在时防具机制，否则返回一个默认值</td>
</tr>
</tbody>
</table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">menu.stream()</div><div class="line">              .filter(Dish::isVegetarian)</div><div class="line">              .findAny()</div><div class="line">              .ifPresent(dish -&gt; System.out.println(dish.getName()));     <span class="comment">//如果包含值就打印它，反之什么都不做</span></div></pre></td></tr></table></figure>
<h4 id="查找第一个元素"><a href="#查找第一个元素" class="headerlink" title="查找第一个元素"></a>查找第一个元素</h4><ul>
<li><strong>findFirser()方法</strong></li>
<li>工作方式类似于findAny()，查找第一个元素</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">List&lt;Integer&gt; integers1 = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>);</div><div class="line">       integers1.stream()</div><div class="line">               .filter(x -&gt; x % <span class="number">3</span> == <span class="number">0</span>)</div><div class="line">               .findFirst()</div><div class="line">               .ifPresent(System.out::println);</div></pre></td></tr></table></figure>
<blockquote>
<p>那么问题来了：何时使用<strong>findFirst</strong>和<strong>findAny</strong></p>
</blockquote>
<ul>
<li>答案是并行，找到第一个元素在并行上限制更多，如果你不关心返回的元素是哪个，请使用findAny()</li>
<li>因为<em>*findAny()</em>在并行流时限制较少</li>
</ul>
<h3 id="归并"><a href="#归并" class="headerlink" title="归并"></a>归并</h3><ul>
<li>使用reduce来操作更为复杂的查询<ul>
<li>此类查询需要将流中的所有元素反复结合起来，得到一个值</li>
</ul>
</li>
<li>这样的查询可以被归类为<strong>归约操作</strong>（将流归约承一个值）</li>
</ul>
<h4 id="元素求和"><a href="#元素求和" class="headerlink" title="元素求和"></a>元素求和</h4><ul>
<li>使用for-each循环来对数字列表中的元素求和</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">      <span class="keyword">for</span> (Integer integer : integers) &#123;</div><div class="line">          sum += integer;</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<ul>
<li>在这里代码有两个参数<ul>
<li>总和变量的初始值，在这里是0</li>
<li>将列表中的所有元素结合在一起的操作，这里是<code>+</code></li>
</ul>
</li>
<li>要是想要将所有的数字想成，而不必复制粘贴这些代码，就要用reduce</li>
</ul>
<blockquote>
<p><strong>reduce()方法</strong></p>
</blockquote>
<ul>
<li>reduce()方法<ul>
<li>对这种重复应用的模式做了抽象</li>
<li><strong>它接受两个参数</strong><ul>
<li>一个初始值，这里是0</li>
<li>一个BinaryOperator<t> 来讲两个元素结合起来产生一个新值</t></li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      <span class="keyword">int</span> reduce = integers.stream()</div><div class="line">              .reduce(<span class="number">0</span>, <span class="keyword">new</span> BinaryOperator&lt;Integer&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(Integer integer, Integer integer2)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> integer + integer2;</div><div class="line">          &#125;</div><div class="line">      &#125;);</div><div class="line"><span class="comment">// 使用Lambda表达式</span></div><div class="line">      List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      <span class="keyword">int</span> reduce = integers.stream()</div><div class="line">              .reduce(<span class="number">0</span>, (integer, integer2) -&gt; integer + integer2);</div><div class="line">      <span class="comment">// 使用方法引用让这段代码更加整洁</span></div><div class="line">List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      <span class="keyword">int</span> reduce = integers.stream()</div><div class="line">              .reduce(<span class="number">0</span>, Integer::sum);</div></pre></td></tr></table></figure>
<blockquote>
<p>无初始值</p>
</blockquote>
<ul>
<li><code>reduce()</code>还有一个重载的辩题，它不接受初始值，但是会返回一个Optional对象</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">integers.stream()</div><div class="line">        .reduce(Integer::sum)</div><div class="line">        .ifPresent(System.out::println);</div></pre></td></tr></table></figure>
<ul>
<li>为什么返回一个<code>Optional&lt;Integer&gt;</code>考虑流中没有任何元素的情况。</li>
<li>reduce操作无法返回其和，<strong>因为它没有初始值</strong></li>
</ul>
<h4 id="最大值和最小值"><a href="#最大值和最小值" class="headerlink" title="最大值和最小值"></a>最大值和最小值</h4><ul>
<li>reduce只要接受两个参数</li>
<li>一个初始值</li>
<li>一个Lambda来把两个流元素应用到流中每个元素上</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*最大值*/</span></div><div class="line">List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      integers.stream().reduce(<span class="number">0</span>, <span class="keyword">new</span> BinaryOperator&lt;Integer&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(Integer integer, Integer integer2)</span> </span>&#123;</div><div class="line">              <span class="keyword">if</span>(integer&gt;integer2)&#123;</div><div class="line">                  <span class="keyword">return</span> integer;</div><div class="line">              &#125;</div><div class="line">              <span class="keyword">return</span> integer2;</div><div class="line">          &#125;</div><div class="line">      &#125;);</div><div class="line">      <span class="comment">// 使用三目运算符</span></div><div class="line">      List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      integers.stream().reduce(<span class="number">0</span>, <span class="keyword">new</span> BinaryOperator&lt;Integer&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(Integer integer, Integer integer2)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> integer &gt; integer2 ? integer : integer2;</div><div class="line">          &#125;</div><div class="line">      &#125;);</div><div class="line">      <span class="comment">// 使用Lambda表达式</span></div><div class="line">      List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      integers.stream().reduce(<span class="number">0</span>, (integer, integer2) -&gt; integer &gt; integer2 ? integer : integer2);</div><div class="line">      <span class="comment">// 修改变量名 太长不优雅</span></div><div class="line">      List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      integers.stream().reduce(<span class="number">0</span>, (x, y) -&gt; x &gt; y ? x : y);</div><div class="line">      <span class="comment">// 使用方法引用 这样就优雅多了</span></div><div class="line">List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      integers.stream().reduce(<span class="number">0</span>, Integer::max);</div><div class="line">      <span class="comment">// 还要更优雅</span></div><div class="line">List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      integers.stream().reduce(Integer::max);</div><div class="line">      <span class="comment">/*最小值*/</span></div><div class="line">List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      <span class="keyword">int</span> reduce = integers.stream().reduce(<span class="number">0</span>, Integer::min);</div><div class="line">      <span class="comment">// 与上面相同 只是没有初始值的时候返回值不同</span></div><div class="line">      List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      <span class="keyword">int</span> reduce = integers.stream().reduce(Integer::min).get();</div></pre></td></tr></table></figure>
<blockquote>
<p>怎样用map和reduce来查询流中有多少元素</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*查询流中共有多少元素*/</span></div><div class="line">      List&lt;Integer&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      <span class="keyword">int</span> reduce = integers.stream().map(<span class="keyword">new</span> Function&lt;Integer, Integer&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(Integer integer)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">          &#125;</div><div class="line">      &#125;).reduce(<span class="number">0</span>, <span class="keyword">new</span> BinaryOperator&lt;Integer&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(Integer o, Integer o2)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> o + o2;</div><div class="line">          &#125;</div><div class="line">      &#125;);</div><div class="line"><span class="comment">// 使用Lambda表达式</span></div><div class="line"><span class="keyword">int</span> reduce = integers.stream().map(x -&gt; <span class="number">1</span>).reduce(<span class="number">0</span>, (x, y) -&gt; x + y);</div><div class="line">      <span class="comment">// 优雅点</span></div><div class="line"><span class="keyword">int</span> reduce = integers.stream().map(x -&gt; <span class="number">1</span>).reduce(<span class="number">0</span>, Integer::sum);</div><div class="line"><span class="comment">// 就是算下大小有点太复杂了，直接使用count</span></div><div class="line"><span class="keyword">long</span> count = integers.stream().count();</div></pre></td></tr></table></figure>
<h5 id="中间操作和终端操作"><a href="#中间操作和终端操作" class="headerlink" title="中间操作和终端操作"></a>中间操作和终端操作</h5><table>
<thead>
<tr>
<th>操作</th>
<th>类型</th>
<th>返回类型</th>
<th>操作参数</th>
<th>函数描述符</th>
</tr>
</thead>
<tbody>
<tr>
<td>filter</td>
<td>中间操作</td>
<td><code>Stream&lt;T&gt;</code></td>
<td><code>Predicate&lt;T&gt;</code></td>
<td><code>T -&gt; boolean</code></td>
</tr>
<tr>
<td>distinct</td>
<td>中间操作(有状态——无界)</td>
<td><code>Stream&lt;T&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td>skip</td>
<td>中间操作(有状态——有界)</td>
<td><code>Stream&lt;T&gt;</code></td>
<td><code>long</code></td>
<td></td>
</tr>
<tr>
<td>limit</td>
<td>中间操作(有状态——有界)</td>
<td><code>Stream&lt;T&gt;</code></td>
<td><code>long</code></td>
<td></td>
</tr>
<tr>
<td>map</td>
<td>中间操作</td>
<td><code>Stream&lt;T&gt;</code></td>
<td><code>Function&lt;T,R&gt;</code></td>
<td><code>T -&gt; R</code></td>
</tr>
<tr>
<td>flatMap</td>
<td>中间操作</td>
<td><code>Stream&lt;T&gt;</code></td>
<td><code>Function&lt;T,Stream&lt;R&gt;&gt;</code></td>
<td><code>T -&gt; Stream&lt;R&gt;</code></td>
</tr>
<tr>
<td>sorted</td>
<td>中间操作(有状态——无界)</td>
<td><code>Stream&lt;T&gt;</code></td>
<td><code>Comparator&lt;T&gt;</code></td>
<td><code>( T , T ) -&gt; int</code></td>
</tr>
<tr>
<td></td>
<td>终</td>
<td>端</td>
<td>操</td>
<td>作</td>
</tr>
<tr>
<td>anyMatch</td>
<td>终端操作</td>
<td><code>boolean</code></td>
<td><code>Predicate&lt;T&gt;</code></td>
<td><code>T -&gt; boolean</code></td>
</tr>
<tr>
<td>noneMatch</td>
<td>终端操作</td>
<td><code>boolean</code></td>
<td><code>Predicate&lt;T&gt;</code></td>
<td><code>T -&gt; boolean</code></td>
</tr>
<tr>
<td>allMatch</td>
<td>终端操作</td>
<td><code>boolean</code></td>
<td><code>Predicate&lt;T&gt;</code></td>
<td><code>T -&gt; boolean</code></td>
</tr>
<tr>
<td>findAny</td>
<td>终端操作</td>
<td><code>Optional&lt;T&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td>findFirst</td>
<td>终端操作</td>
<td><code>Optional&lt;T&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td>forEach</td>
<td>终端操作</td>
<td><code>void</code></td>
<td><code>consumer&lt;T&gt;</code></td>
<td><code>T -&gt; void</code></td>
</tr>
<tr>
<td>collect</td>
<td>终端操作</td>
<td><code>R</code></td>
<td><code>Collector&lt;T,A,R&gt;</code></td>
<td></td>
</tr>
<tr>
<td>reduce</td>
<td>终端操作(有状态——有界)</td>
<td><code>Optional&lt;T&gt;</code></td>
<td><code>BinaryOperator&lt;T&gt;</code></td>
<td><code>( T , T ) -&gt; T</code></td>
</tr>
<tr>
<td>count</td>
<td>终端操作</td>
<td><code>long</code></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="付诸实践"><a href="#付诸实践" class="headerlink" title="付诸实践"></a>付诸实践</h3><ul>
<li>当你对list中的元素进行去重的时候，可以考虑使用<code>toSet()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; collect = transactions.stream()</div><div class="line">              .map(x -&gt; x.getTrader().getCity())</div><div class="line">              .distinct()</div><div class="line">              .collect(Collectors.toList());</div></pre></td></tr></table></figure>
<ul>
<li>[x] 使用<code>toSet()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//使用toSet()        </span></div><div class="line"> Set&lt;String&gt; collect = transactions.stream()</div><div class="line">              .map(x -&gt; x.getTrader().getCity())</div><div class="line">              .collect(Collectors.toSet());</div></pre></td></tr></table></figure>
<ul>
<li>连接字符串效率不高，可以考虑使用<code>Collectors.joining()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">String collect = transactions.stream()</div><div class="line">              .map((Transaction t) -&gt; t.getTrader().getName())</div><div class="line">              .sorted()</div><div class="line">              .distinct()</div><div class="line">              .reduce((str1, str2) -&gt; str1 + str2).get();</div></pre></td></tr></table></figure>
<ul>
<li>[x] 使用<code>Collectors.joining()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">String collect = transactions.stream()</div><div class="line">              .map((Transaction t) -&gt; t.getTrader().getName())</div><div class="line">              .sorted()</div><div class="line">              .distinct().collect(Collectors.joining());</div></pre></td></tr></table></figure>
<ul>
<li>流支持 <strong>min()</strong> 和 <strong>max()</strong> 方法，他们可以接受一个Comparator作为参数，制定计算最大或最小值要比较哪个键值</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Transaction transaction = transactions.stream()</div><div class="line">              .reduce((x, y) -&gt; x.getValue() &gt; y.getValue() ? x : y)</div><div class="line">              .get();</div></pre></td></tr></table></figure>
<ul>
<li>[x] 使用 <strong>min()</strong>方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Transaction transaction = transactions.stream()</div><div class="line">              .min(Comparator.comparing(Transaction::getValue))</div><div class="line">              .get();</div></pre></td></tr></table></figure>
<h3 id="数值流"><a href="#数值流" class="headerlink" title="数值流"></a>数值流</h3><ul>
<li>在前面我们看到了可以使用 <strong>reduce()</strong> 方法计算流中元素的总和</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> reduce = menu.stream()</div><div class="line">              .map(Dish::getCalories)</div><div class="line">              .reduce(<span class="number">0</span>, Integer::sum);</div></pre></td></tr></table></figure>
<ul>
<li>这段代码的问题是，它有一个暗含的装箱成本， 每个Integer都必须拆箱承一个原始类型再进行求和</li>
<li>为此，Stream API 提供了原始类型流特化,专门处理数值流的办法</li>
</ul>
<h4 id="原始类型流特化"><a href="#原始类型流特化" class="headerlink" title="原始类型流特化"></a>原始类型流特化</h4><ul>
<li>Java8 引入了三个原始类型特化流接口<ul>
<li><strong>IntStream</strong></li>
<li><strong>DoubleStream</strong></li>
<li><strong>LongStream</strong></li>
</ul>
</li>
<li>分别将流中的元素特化为 int 、long 和 double，从而避免暗含的装箱成本</li>
</ul>
<blockquote>
<p>映射到数值流</p>
</blockquote>
<ul>
<li>将流转换为特化版本的常用方法 <strong>mapToInt()</strong> 、 <strong>mapToDouble()</strong> 和 <strong>mapToLong()</strong></li>
<li>这些方法和 map 方法的工作方式一样，只是他们返回的是一个特化流，而不是 `Stream<t>``</t></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> sum = menu.stream()</div><div class="line">              .mapToInt(Dish::getCalories)</div><div class="line">              .sum();</div></pre></td></tr></table></figure>
<ul>
<li>如果流是空的，<strong>sum()</strong>方法 默认返回0</li>
<li>IntStream 还支持其他的方法方法，如 <strong>max()</strong>、<strong>min()</strong>、<strong>average()</strong> 等</li>
</ul>
<blockquote>
<p>转换为对象流</p>
</blockquote>
<ul>
<li>要将原始流转换为一般流，可以使用 <strong>boxed()</strong> 方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">IntStream intStream = menu.stream()</div><div class="line">              .mapToInt(Dish::getCalories);</div><div class="line">      Stream&lt;Integer&gt; boxed = intStream.boxed();</div></pre></td></tr></table></figure>
<blockquote>
<p>默认值 <strong>OptionalInt</strong></p>
</blockquote>
<ul>
<li>求和的例子很简单，因为它有一个默认值： 0 </li>
<li>如果你要计算 IntStream 中的最大元素，就得换个方法了，因为0是错误的结果</li>
<li>如何区分没有元素的流和元素最大的流呢？</li>
<li>对于三种原始流特化，也分别有一个 Optional 原始类型特化版本：<ul>
<li><strong>OptionalInt</strong></li>
<li><strong>OptionDouble</strong></li>
<li><strong>OptionalLong</strong></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">OptionalInt opt = menu.stream()</div><div class="line">              .mapToInt(Dish::getCalories)</div><div class="line">              .max();</div><div class="line">      <span class="keyword">int</span> max = opt.orElse(<span class="number">520</span>);		<span class="comment">// 如果没有默认值的话，显式的提供一个默认最大值</span></div></pre></td></tr></table></figure>
<ul>
<li>有的时候无法区分是没有元素的流，还是最大值真的是0的流，可以显式处理 OptionalInt 去定义一个默认最大值</li>
</ul>
<blockquote>
<p>如果没有最大值的话，可以显式的处理 <strong>OptionalInt</strong> 去定义一个默认值</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> max = opt.orElse(<span class="number">520</span>);		<span class="comment">// 如果没有默认值的话，显式的提供一个默认最大值</span></div></pre></td></tr></table></figure>
<h4 id="数值范围"><a href="#数值范围" class="headerlink" title="数值范围"></a>数值范围</h4><ul>
<li>java8 引入了两个一个用于 IntStream 和 LongStream 的静态方法，帮助生成这种范围<ul>
<li>range()</li>
<li>rangeClosed()</li>
</ul>
</li>
<li>这两个方法都是第一个参数接受起始值，第二个参数接受结束值。</li>
<li>range() 是不包括结束值的    <code>[x,y)</code></li>
<li>rangeClosed() 包含结束值    <code>[x,y]</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 调用range(...)方法</span></div><div class="line">IntStream range = IntStream.range(<span class="number">1</span>, <span class="number">5</span>);</div><div class="line">      range.forEach(System.out::print);</div><div class="line"></div><div class="line">outPut: <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span></div><div class="line"></div><div class="line"><span class="comment">// 调用rangeClosed(...)方法</span></div><div class="line">      IntStream range2 = IntStream.rangeClosed(<span class="number">1</span>, <span class="number">5</span>);</div><div class="line">      range2.forEach(System.out::print);</div><div class="line"></div><div class="line">      outPut: <span class="number">1</span> <span class="number">2</span>  <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></div></pre></td></tr></table></figure>
<h4 id="数值流应用-勾股数"><a href="#数值流应用-勾股数" class="headerlink" title="数值流应用 勾股数"></a>数值流应用 勾股数</h4><h3 id="构建流"><a href="#构建流" class="headerlink" title="构建流"></a>构建流</h3><h4 id="由值创建流"><a href="#由值创建流" class="headerlink" title="由值创建流"></a>由值创建流</h4><ul>
<li>可以使用静态方法 <strong>Stream.of(…)</strong> 通过显式值创建一个流</li>
<li>可以使用 <strong>empty()</strong>创建一个空流</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Stream&lt;Integer&gt; integerStream = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line">      integerStream.forEach(System.out::println);</div><div class="line">      </div><div class="line">      <span class="comment">// 创建一个空流</span></div><div class="line">      Stream&lt;Object&gt; emptyStream = Stream.empty();</div></pre></td></tr></table></figure>
<h4 id="由数组创建流"><a href="#由数组创建流" class="headerlink" title="由数组创建流"></a>由数组创建流</h4><ul>
<li>你可以使用静态方法 <strong>Arrays.stream(…)</strong> 从数组创建一个流</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span>[] nums = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</div><div class="line"><span class="keyword">int</span> sum = Arrays.stream(nums).sum();</div></pre></td></tr></table></figure>
<h4 id="由文件创建流"><a href="#由文件创建流" class="headerlink" title="由文件创建流"></a>由文件创建流</h4><ul>
<li>java中用与处理文件等I/O操作的NIO API（非阻塞I/O）已更新，以便利用 Stream API</li>
<li><code>java.nio.file.Files</code> 中的很多静态方法都会返回一个流。</li>
<li>一个很有用的方法 <strong>Files.readLines()</strong><ul>
<li>它会返回一个由指定文件中的各行构成的字符串流。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Files.lines(Paths.get(<span class="string">"C:\\Users\\Administrator\\Desktop\\dd.txt"</span>), Charset.defaultCharset())</div><div class="line">                  .flatMap(line -&gt; Arrays.stream(line.split(<span class="string">" "</span>)))</div><div class="line">                  .forEach(System.out::println);</div></pre></td></tr></table></figure>
<ul>
<li>[x] 上面的方法是每一行生成一个单词流，我们修改一下产生一个扁平化的单词流</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Files.lines(Paths.get(<span class="string">"C:\\Users\\Administrator\\Desktop\\dd.txt"</span>), Charset.defaultCharset())</div><div class="line">                  .map(line -&gt; line.split(<span class="string">" "</span>))</div><div class="line">                  .flatMap(lines -&gt; Arrays.stream(lines))</div><div class="line">                  .forEach(System.out::println);</div></pre></td></tr></table></figure>
<h4 id="由函数创建流-创建无限流"><a href="#由函数创建流-创建无限流" class="headerlink" title="由函数创建流  创建无限流"></a>由函数创建流  创建无限流</h4><ul>
<li>Stream API 提供了两个静态方法从函数创建流：<ul>
<li><strong>Stream.iterate(…)</strong></li>
<li><strong>Stream.generate(…)</strong></li>
</ul>
</li>
<li>这两个操作可以创建所谓的无限流：不想固定集合创建的流那样有固定大小的流</li>
<li>由 <strong>iterate</strong> 和 <strong>generate</strong> 创建的流会用给定的函数按需创建主，因此可以无线创建下去</li>
</ul>
<blockquote>
<p>Stream.iterate(…)<br>第一个参数是初始值，第二个参数是一个Lambda表达式(<code>UnaryOperator&lt;T&gt;</code>类型【UnaryOperator ♥ 一元运算符】)</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Stream.iterate(<span class="number">0</span>, <span class="keyword">new</span> UnaryOperator&lt;Integer&gt;() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(Integer integer)</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> integer + <span class="number">2</span>;</div><div class="line">          &#125;</div><div class="line">      &#125;).forEach(System.out::println);</div><div class="line">      </div><div class="line"><span class="comment">// 使用Lambda表达式</span></div><div class="line">      Stream.iterate(<span class="number">0</span>, n -&gt; n + <span class="number">2</span>).forEach(System.out::println);</div></pre></td></tr></table></figure>
<blockquote>
<p>这样得到的是一个无限流，我们使用 <strong>limit(…)</strong>方法显式的限制流的大小。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Stream.iterate(<span class="number">0</span>, n -&gt; n + <span class="number">2</span>).limit(<span class="number">10</span>).forEach(System.out::println);</div></pre></td></tr></table></figure>
<blockquote>
<p>Stream.generate(…)</p>
</blockquote>
<ul>
<li>与iterate方法类似，generate方法也可以让你按需生成一个无限流。但generate不是一次对每个新生成的值应用函数的。</li>
<li>它接受一个供应源<code>Supplier&lt;T&gt;</code>类型的Lambda提供的值。</li>
</ul>
<ul>
<li>[x] 示例代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Stream.generate(Math::random)</div><div class="line">              .limit(<span class="number">10</span>)</div><div class="line">              .forEach(System.out::println);</div></pre></td></tr></table></figure>
<ul>
<li>[x] 使用 <strong>IntStream</strong> 说明避免装箱操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">IntStream.generate(<span class="keyword">new</span> IntSupplier() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAsInt</span><span class="params">()</span> </span>&#123;</div><div class="line">              <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">          &#125;</div><div class="line">      &#125;).limit(<span class="number">20</span>)</div><div class="line">      .forEach(System.out::print);</div><div class="line"><span class="comment">// 使用Lambda表达式</span></div><div class="line">IntStream.generate(() -&gt; <span class="number">2</span>)</div><div class="line">              .limit(<span class="number">20</span>)</div><div class="line">              .forEach(System.out::print);</div><div class="line">              IntStream.generate(() -&gt; <span class="number">2</span>)</div><div class="line">              .limit(<span class="number">20</span>)</div><div class="line">              .forEach(System.out::print);</div></pre></td></tr></table></figure>
<ul>
<li><strong>generate()</strong> 方法将是用给定的供应源,并反复的调用 <strong>getAsInt()</strong> 而这个方法总是返回2</li>
</ul>
<ul>
<li>[x] 比较 <strong>generate()</strong> 和 <strong>iterate()</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用iterate()方法</span></div><div class="line">Stream.iterate(<span class="number">0</span>, x -&gt; x + <span class="number">2</span>).limit(<span class="number">5</span>).forEach(System.out::println);</div><div class="line"></div><div class="line"><span class="comment">// 使用 generate(...)方法</span></div><div class="line">IntSupplier intSupplier = <span class="keyword">new</span> IntSupplier() &#123;</div><div class="line">          <span class="keyword">int</span> previous = <span class="number">0</span>;</div><div class="line"></div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAsInt</span><span class="params">()</span> </span>&#123;</div><div class="line">              <span class="keyword">int</span> oldPrevious = <span class="keyword">this</span>.previous;</div><div class="line">              <span class="keyword">this</span>.previous = <span class="keyword">this</span>.previous + <span class="number">2</span>;</div><div class="line">              ;</div><div class="line">              <span class="keyword">return</span> oldPrevious;</div><div class="line">          &#125;</div><div class="line">      &#125;;</div><div class="line"></div><div class="line">      Stream.generate(intSupplier).limit(<span class="number">5</span>).forEach(System.out::println);</div><div class="line"></div><div class="line">outPut:	<span class="number">0</span>	<span class="number">2</span>	<span class="number">4</span>	<span class="number">6</span>	<span class="number">8</span></div></pre></td></tr></table></figure>
<ul>
<li>前面的代码创建了一个 <strong>IntSupplier</strong> 的实例</li>
<li>此对象有可变的状态：他在两个实例变量中记录了前一个数，<strong>getAsInt()</strong> 在调用时会改变对象的状态，由此在每次调用时产生新的值</li>
</ul>
<blockquote>
<p>注意：</p>
</blockquote>
<ul>
<li>你应该始终采用<strong>不变的方法</strong>，以便并行处理流，并保持结果正确。</li>
<li>因为你处理的是一个无限流，所以必须使用 limit 操作来显式的限制流的大小，否则，终端操作（这里是forEach）将永远计算下去</li>
<li><strong>你不能对无限流做排序或归约</strong>，因为所有的元素都要处理，而这永远也完不成</li>
</ul>
<h3 id="小结-3"><a href="#小结-3" class="headerlink" title="小结"></a>小结</h3><ul>
<li>Stream API 可以表达复杂的数据处理查询</li>
<li>你可以使用 <strong>filter</strong>、 <strong>distinct</strong>、 <strong>skip</strong> 和 <strong>limit</strong> 对流做筛选和切片</li>
<li>你可以使用 <strong>map</strong> 和 <strong>flatMap</strong> 提取或转换流中的元素</li>
<li>你可以使用 <strong>findFirst</strong> 和 <strong>findAny</strong> 方法查找流中的元素</li>
<li>你可以用 <strong>allMatch</strong>、 <strong>noneMatch</strong> 和 <strong>anyMatch</strong> 方法让流匹配给定的谓词</li>
<li>这些方法都利用了短路：找到结果就立即停止计算；没有必要处理整个流</li>
<li>你可以利用 <strong>reduce</strong> 方法将流中的所有元素迭代合并成一个结果，例如求和或查找最大元素</li>
<li><strong>filter</strong> 和 <strong>map</strong> 等操作是无状态的，他们并不存储任何状态。<strong>resuce</strong> 等操作要存储状态才能计算出一个值。 <strong>sorted</strong>  和 <strong>distinct</strong> 等操作也要存储状态 ，因为他们要把流中的所有元素缓存起来才能返回一个新的流。这种操作称为<strong>有状态操作</strong></li>
<li>流有三种最基本的原始类型特化： <strong>IntStream</strong> 、 <strong>DoubleStream</strong> 和 <strong>LongStream</strong> ,他们的操作也有相应的特化</li>
<li>流不仅可以从集合创建，也可从数值、数组、文件以及 <strong>iterate</strong> 与 <strong>generate</strong> 等特定方法创建</li>
<li>无限流是没有固定大小的流</li>
</ul>
<h2 id="第6章-用流收集数据"><a href="#第6章-用流收集数据" class="headerlink" title="第6章 用流收集数据"></a>第6章 用流收集数据</h2>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2016/09/07/160805_lambda/">java8</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">Benny</a></p>
        <p><span>发布时间:</span>2016-09-07, 09:50:27</p>
        <p><span>最后更新:</span>2016-09-14, 17:32:23</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2016/09/07/160805_lambda/" title="java8">/2016/09/07/160805_lambda/</a>
            <span class="copy-path" data-clipboard-text="原文: /2016/09/07/160805_lambda/　　作者: Benny" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2016/08/18/160818_junit_spirng_mock/">
                    基于Spring web 做单元测试
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#java8-基础知识"><span class="toc-number">1.</span> <span class="toc-text">java8 基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#java8-Lambda表达式"><span class="toc-number">1.1.</span> <span class="toc-text">java8 Lambda表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#从苹果List中找出红颜色的苹果"><span class="toc-number">1.1.1.</span> <span class="toc-text">从苹果List中找出红颜色的苹果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#此时如果增加新的需求要过滤绿色怎么办"><span class="toc-number">1.1.2.</span> <span class="toc-text">此时如果增加新的需求要过滤绿色怎么办</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用接口Predicate"><span class="toc-number">1.1.3.</span> <span class="toc-text">使用接口Predicate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用大招-Lamda表达式-重构之前的方法-以过滤红苹果示例："><span class="toc-number">1.1.4.</span> <span class="toc-text">使用大招 Lamda表达式 重构之前的方法,以过滤红苹果示例：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#从方法传递到-lambda"><span class="toc-number">1.1.5.</span> <span class="toc-text">从方法传递到 lambda</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#流"><span class="toc-number">1.1.6.</span> <span class="toc-text">流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#集合的操作更加的人性化"><span class="toc-number">1.1.7.</span> <span class="toc-text">集合的操作更加的人性化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#默认方法"><span class="toc-number">1.1.8.</span> <span class="toc-text">默认方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第2章-通过行为参数化传递代码"><span class="toc-number">1.2.</span> <span class="toc-text">第2章 通过行为参数化传递代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#重构你的垃圾代码"><span class="toc-number">1.2.1.</span> <span class="toc-text">重构你的垃圾代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用Runnable-执行代码块"><span class="toc-number">1.2.2.</span> <span class="toc-text">用Runnable 执行代码块</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第3章-Lambda-表达式"><span class="toc-number">1.3.</span> <span class="toc-text">第3章 Lambda 表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#详解-Lambda-表达式"><span class="toc-number">1.3.1.</span> <span class="toc-text">详解 Lambda 表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java中有效的表达式"><span class="toc-number">1.3.2.</span> <span class="toc-text">java中有效的表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#函数式接口"><span class="toc-number">1.3.3.</span> <span class="toc-text">函数式接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#附录2：Java8中常用的函数式接口："><span class="toc-number">1.3.3.1.</span> <span class="toc-text">附录2：Java8中常用的函数式接口：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#函数描述符"><span class="toc-number">1.3.4.</span> <span class="toc-text">函数描述符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#把Lambda-付诸实践，环绕执行模式"><span class="toc-number">1.3.5.</span> <span class="toc-text">把Lambda 付诸实践，环绕执行模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用函数式接口"><span class="toc-number">1.3.6.</span> <span class="toc-text">使用函数式接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Predicate（谓词）"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">Predicate（谓词）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Consumer（消费者）"><span class="toc-number">1.3.6.2.</span> <span class="toc-text">Consumer（消费者）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Function"><span class="toc-number">1.3.6.3.</span> <span class="toc-text">Function</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始类型特化"><span class="toc-number">1.3.7.</span> <span class="toc-text">原始类型特化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#java8常用函数式接口"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">java8常用函数式接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#附录1：Lambda及函数式接口的例子："><span class="toc-number">1.3.7.2.</span> <span class="toc-text">附录1：Lambda及函数式接口的例子：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异常、Lambda，还有函数式接口是什么鬼"><span class="toc-number">1.3.8.</span> <span class="toc-text">异常、Lambda，还有函数式接口是什么鬼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类型检查-类型推断-以及限制"><span class="toc-number">1.3.9.</span> <span class="toc-text">类型检查 类型推断 以及限制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#类型检查"><span class="toc-number">1.3.9.1.</span> <span class="toc-text">类型检查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#类型推断"><span class="toc-number">1.3.9.2.</span> <span class="toc-text">类型推断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用局部变量"><span class="toc-number">1.3.9.3.</span> <span class="toc-text">使用局部变量</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方法引用"><span class="toc-number">1.3.10.</span> <span class="toc-text">方法引用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#管中窥豹"><span class="toc-number">1.3.10.1.</span> <span class="toc-text">管中窥豹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lambda及其等效方法引用的例子"><span class="toc-number">1.3.10.1.1.</span> <span class="toc-text">Lambda及其等效方法引用的例子</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#如何构建方法引用"><span class="toc-number">1.3.10.1.2.</span> <span class="toc-text">如何构建方法引用</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#构造函数引用"><span class="toc-number">1.3.10.2.</span> <span class="toc-text">构造函数引用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lambda和方法引用实战"><span class="toc-number">1.3.11.</span> <span class="toc-text">Lambda和方法引用实战</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#第一步：传递代码"><span class="toc-number">1.3.11.1.</span> <span class="toc-text">第一步：传递代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第二步：使用匿名类"><span class="toc-number">1.3.11.2.</span> <span class="toc-text">第二步：使用匿名类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用Lambda表达式"><span class="toc-number">1.3.11.3.</span> <span class="toc-text">使用Lambda表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用方法引用"><span class="toc-number">1.3.11.4.</span> <span class="toc-text">使用方法引用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#复合Lambda表达式的有用方法"><span class="toc-number">1.3.12.</span> <span class="toc-text">复合Lambda表达式的有用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#比较器复合"><span class="toc-number">1.3.12.1.</span> <span class="toc-text">比较器复合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#谓词复合"><span class="toc-number">1.3.12.2.</span> <span class="toc-text">谓词复合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#函数复合"><span class="toc-number">1.3.12.3.</span> <span class="toc-text">函数复合</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#小结"><span class="toc-number">1.3.13.</span> <span class="toc-text">小结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二部分-函数式数据处理"><span class="toc-number">2.</span> <span class="toc-text">第二部分 函数式数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#第4章-引入流"><span class="toc-number">2.1.</span> <span class="toc-text">第4章 引入流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#流是什么"><span class="toc-number">2.1.1.</span> <span class="toc-text">流是什么</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#小结-1"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#流简介"><span class="toc-number">2.1.2.</span> <span class="toc-text">流简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#流的定义"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">流的定义</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#流与集合"><span class="toc-number">2.1.3.</span> <span class="toc-text">流与集合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#只能遍历一次"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">只能遍历一次</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#外部迭代与内部迭代"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">外部迭代与内部迭代</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#流操作"><span class="toc-number">2.1.4.</span> <span class="toc-text">流操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#中间操作"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">中间操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#终端操作"><span class="toc-number">2.1.4.2.</span> <span class="toc-text">终端操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用流"><span class="toc-number">2.1.4.3.</span> <span class="toc-text">使用流</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#中间操作-1"><span class="toc-number">2.1.4.3.1.</span> <span class="toc-text">中间操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#终端操作-1"><span class="toc-number">2.1.4.3.2.</span> <span class="toc-text">终端操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#小结-2"><span class="toc-number">2.1.5.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第5章"><span class="toc-number">2.2.</span> <span class="toc-text">第5章</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#筛选和切片"><span class="toc-number">2.2.1.</span> <span class="toc-text">筛选和切片</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#用谓词筛选"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">用谓词筛选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#筛选各异的元素"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">筛选各异的元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#截断流"><span class="toc-number">2.2.1.3.</span> <span class="toc-text">截断流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#跳过元素"><span class="toc-number">2.2.1.4.</span> <span class="toc-text">跳过元素</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#映射"><span class="toc-number">2.2.2.</span> <span class="toc-text">映射</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#对流中每一个元素应用函数"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">对流中每一个元素应用函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#流的扁平化"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">流的扁平化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查找和匹配"><span class="toc-number">2.2.3.</span> <span class="toc-text">查找和匹配</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#检查谓词是否至少匹配一个元素"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">检查谓词是否至少匹配一个元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#检查谓词是否匹配所有元素"><span class="toc-number">2.2.3.2.</span> <span class="toc-text">检查谓词是否匹配所有元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查找元素"><span class="toc-number">2.2.3.3.</span> <span class="toc-text">查找元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查找第一个元素"><span class="toc-number">2.2.3.4.</span> <span class="toc-text">查找第一个元素</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#归并"><span class="toc-number">2.2.4.</span> <span class="toc-text">归并</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#元素求和"><span class="toc-number">2.2.4.1.</span> <span class="toc-text">元素求和</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#最大值和最小值"><span class="toc-number">2.2.4.2.</span> <span class="toc-text">最大值和最小值</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#中间操作和终端操作"><span class="toc-number">2.2.4.2.1.</span> <span class="toc-text">中间操作和终端操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#付诸实践"><span class="toc-number">2.2.5.</span> <span class="toc-text">付诸实践</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数值流"><span class="toc-number">2.2.6.</span> <span class="toc-text">数值流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#原始类型流特化"><span class="toc-number">2.2.6.1.</span> <span class="toc-text">原始类型流特化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数值范围"><span class="toc-number">2.2.6.2.</span> <span class="toc-text">数值范围</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数值流应用-勾股数"><span class="toc-number">2.2.6.3.</span> <span class="toc-text">数值流应用 勾股数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#构建流"><span class="toc-number">2.2.7.</span> <span class="toc-text">构建流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#由值创建流"><span class="toc-number">2.2.7.1.</span> <span class="toc-text">由值创建流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#由数组创建流"><span class="toc-number">2.2.7.2.</span> <span class="toc-text">由数组创建流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#由文件创建流"><span class="toc-number">2.2.7.3.</span> <span class="toc-text">由文件创建流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#由函数创建流-创建无限流"><span class="toc-number">2.2.7.4.</span> <span class="toc-text">由函数创建流  创建无限流</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#小结-3"><span class="toc-number">2.2.8.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第6章-用流收集数据"><span class="toc-number">2.3.</span> <span class="toc-text">第6章 用流收集数据</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"java8　| Benny　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section class="youyan" id="comments">
    <script>
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = 'http://v2.uyan.cc/code/uyan.js?uid=2105061';
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

    <div id="uyan_frame"></div>
</section>
    




    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2016/08/18/160818_junit_spirng_mock/" title="下一篇: 基于Spring web 做单元测试">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/09/07/160805_lambda/">java8</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/18/160818_junit_spirng_mock/">基于Spring web 做单元测试</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/17/160817_yaml/">YAML</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/15/160815_Thymeleaf/">Thymeleaf模板</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/12/160812_spring_boot/">Spring Boot</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/11/160811_beetl/">好用的java模板引擎Beetl</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/10/160810_guava_read/">使用Guava来编写优雅的代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/08/160808_idea_shortcutKeys/">Intellij idea的快捷键</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/06/160806_vim/">vim</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/04/160804_sc_spring/">【源码阅读】Spring源码阅读</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/03/160803_analyze_javaweb/">深入分析Java Web</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/02/160802_designpatern_read/">设计模式之禅</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/01/160801_sc_arraylist/">ArrayList源码阅读</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/25/160725_rsa_algorithm/">RSA加密签名</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/06/160706_linuxcommand/">关于Linux命令的那点小事</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/05/160705_plantuml/">plantUML的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/03/160703_linuxShellLine/">Linux Shell 命令行及脚本编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/02/160706_clean_code/">代码整洁之道</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/30/160630_jqueryplugin/">jQuery plugin 插件编写时遇到的问题总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/28/160628_first/">博客初搭建</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016 Benny
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>
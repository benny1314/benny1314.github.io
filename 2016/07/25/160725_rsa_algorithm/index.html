<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Benny" />



<meta name="description" content="加密算法">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA加密签名">
<meta property="og:url" content="/2016/07/25/160725_rsa_algorithm/index.html">
<meta property="og:site_name" content="Benny">
<meta property="og:description" content="加密算法">
<meta property="og:image" content="http://ww2.sinaimg.cn/large/c85e4a5cgw1f62hzfvzwwj20hs0qogpo.jpg">
<meta property="og:image" content="http://chart.googleapis.com/chart?cht=tx&chl=a%5E%7B%5Cphi(n">
<meta property="og:image" content="http://chart.googleapis.com/chart?cht=tx&chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n">
<meta property="og:image" content="http://chart.googleapis.com/chart?cht=tx&chl=%5Cphi(p%5E%7Bk%7D">
<meta property="og:image" content="http://chart.googleapis.com/chart?cht=tx&chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n">
<meta property="og:image" content="http://chart.googleapis.com/chart?cht=tx&chl=a%5E%7B%5Cphi(n">
<meta property="og:image" content="http://image.beekka.com/blog/201307/bg2013070302.png">
<meta property="og:updated_time" content="2016-07-25T01:50:59.691Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RSA加密签名">
<meta name="twitter:description" content="加密算法">
<meta name="twitter:image" content="http://ww2.sinaimg.cn/large/c85e4a5cgw1f62hzfvzwwj20hs0qogpo.jpg">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Benny" type="application/atom+xml">



    <link rel="shortcut icon" href="http://file.ipadown.com/uploads/mjh/r3cqsmmw1pa.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>RSA加密签名 | Benny</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="http://file.ipadown.com/uploads/mjh/r3cqsmmw1pa.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Benny</a></h1>
        </hgroup>

        
        <p class="header-subtitle">Coding is my life</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:xiaoc1314@163.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/List/">List</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RSA/">RSA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdk8/">jdk8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery-plugin/">jquery plugin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plantUML/">plantUML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码整洁/">代码整洁</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/加密/">加密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/源码/">源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程/">编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/问题/">问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/集合/">集合</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Coding is my life</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Benny</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="http://file.ipadown.com/uploads/mjh/r3cqsmmw1pa.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Benny</a></h1>
            </hgroup>
            
            <p class="header-subtitle">Coding is my life</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:xiaoc1314@163.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-160725_rsa_algorithm" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/25/160725_rsa_algorithm/" class="article-date">
      <time datetime="2016-07-25T01:50:27.000Z" itemprop="datePublished">2016-07-25</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      RSA加密签名
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/算法/">算法</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RSA/">RSA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/加密/">加密</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/算法/">算法</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h2><p><img src="http://ww2.sinaimg.cn/large/c85e4a5cgw1f62hzfvzwwj20hs0qogpo.jpg" alt="就问你美不美"></p>
<a id="more"></a>
<h3 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h3><ul>
<li>(1) 甲方选择某一种加密规则，对信息进行加密；　　</li>
<li>(2) 乙方使用同一种规则，对信息进行解密。 </li>
<li>(3) 加密和解秘使用同一种规则，对信息进行解谜</li>
</ul>
<blockquote>
<p>这种加密模式有一个最大弱点：甲方必须把加密规则告诉乙方，否则无法解密。保存和传递密钥，就成了最头疼的问题。    </p>
</blockquote>
<h3 id="非对称加密算法"><a href="#非对称加密算法" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h3><ul>
<li>(1)乙方生成两把密钥（公钥和私钥）。公钥是公开的，任何人都可以获得，私钥则是保密的。</li>
<li>(2) 甲方获取乙方的公钥，然后用它对信息加密。</li>
<li>(3) 乙方得到加密后的信息，用私钥解密。</li>
</ul>
<blockquote>
<p>如果公钥加密的信息只有私钥解得开，那么只要私钥不泄漏，通信就是安全的。</p>
</blockquote>
<ul>
<li>三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，这种算法用他门三个人的名字命名，叫做RSA算法。</li>
</ul>
<h3 id="你需要知道的数论知识"><a href="#你需要知道的数论知识" class="headerlink" title="你需要知道的数论知识"></a>你需要知道的数论知识</h3><ul>
<li>(1) 互质关系<ul>
<li>如果两个正整数，除了1以外，没有其他公因子，我们就称这两个数是互质关系（coprime）。</li>
</ul>
</li>
<li>(2) 欧拉函数</li>
<li>(3) 欧拉定理<ul>
<li>如果两个正整数a和n互质，则n的欧拉函数 φ(n)可以让下面的等式成立：</li>
<li><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=a%5E%7B%5Cphi(n" alt="image">%7D%5Cequiv%5C1%20(mod%5C%20n)&amp;chs=60)</li>
</ul>
</li>
<li>模反元素<ul>
<li>如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1被n整除，或者说ab被n除的余数是1。</li>
<li><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n" alt="image">&amp;chs=40)</li>
<li>这时，b就叫做a的”模反元素”。</li>
</ul>
</li>
</ul>
<h3 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h3><ul>
<li>任意给定正整数<code>n</code>，请问在小于等于<code>n</code>的正整数之中，有多少个数与<code>n</code>构成互质关系，计算这个值的方法叫做<code>欧拉函数</code></li>
<li>以<code>φ(n)</code>表示。<ul>
<li>在1到8之中，与8形成互质关系的是1、3、5、7，所以 <code>φ(8) = 4</code>。</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><code>第一种情况:如果是1</code><ul>
<li>如果<code>n=1</code>，则 <code>φ(1) = 1</code> 。因为1与任何数（包括自身）都构成互质关系。</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><code>第二种情况：如果是质数</code><ul>
<li>如果<code>n</code>是质数，则 <code>φ(n)=n-1</code>。</li>
<li>因为质数与小于它的每一个数，都构成互质关系。比如<code>5</code>与<code>1</code>、<code>2</code>、<code>3</code>、<code>4</code>都构成互质关系。</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><code>第三种情况:如果是质数的某一个次方</code><ul>
<li>如果<code>n</code>是质数的某一个次方，即 <code>n = p^k</code>（<code>p</code>为质数，<code>k</code>为大于等于1的整数），则</li>
<li><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=%5Cphi(p%5E%7Bk%7D" alt="image">%3Dp%5E%7Bk%7D-p%5E%7Bk-1%7D&amp;chs=40)</li>
<li>比如 φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4。</li>
<li>这是因为只有当一个数不包含质数<code>p</code>，才可能与n互质。而包含质数<code>p</code>的数一共有<code>p^(k-1)</code>个，即1×p、2×p、3×p、…、p^(k-1)×p，把它们去除，剩下的就是与<code>n</code>互质的数。</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><p><code>第四种情况：如果n可以分解成两个互质的整数之积</code></p>
<ul>
<li><p>如果n可以分解成两个互质的整数之积</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　n = p1 × p2</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<pre><code>+ 则

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　φ(n) = φ(p1p2) = φ(p1)φ(p2)</div></pre></td></tr></table></figure>

+ 积的欧拉函数等于各个因子的欧拉函数之积。比如，φ(56)=φ(8×7)=φ(8)×φ(7)=4×6=24。
</code></pre><h3 id="模反元素"><a href="#模反元素" class="headerlink" title="模反元素"></a>模反元素</h3><ul>
<li>如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1 被n整除，或者说ab被n除的余数是1，也就是<code>ab / n = 1</code></li>
<li><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n" alt="image">&amp;chs=40)</li>
<li>欧拉定理可以用来证明模反元素必然存在。</li>
<li><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=a%5E%7B%5Cphi(n" alt="image">%7D%3Da%5Ctimes%20a%5E%7B%5Cphi(n)-1%7D%5Cequiv%5C%201%5C%20(mod%5C%20n)%20&amp;chs=40)</li>
<li>可以看到，a的 φ(n)-1 次方，就是a的模反元素。</li>
<li>比如，3和11互质，那么3的模反元素就是4，因为 (3 × 4)-1 可以被11整除。显然，模反元素不止一个， 4加减11的整数倍都是3的模反元素 {…,-18,-7,4,15,26,…}，即如果b是a的模反元素，则 b+kn 都是a的模反元素。</li>
<li>欧拉定理可以用来证明模反元素必然存在。</li>
</ul>
<h3 id="RSA数学原理"><a href="#RSA数学原理" class="headerlink" title="RSA数学原理"></a>RSA数学原理</h3><ul>
<li>RSA加密 密文 = 明文e次方 Mod (就是%取余的意思) N 公钥 （e,N）  </li>
<li>RSA解密 明文 = 密文d次方 Mod (就是%取余的意思) N 私钥 （d,N） </li>
</ul>
<h3 id="jDK实现"><a href="#jDK实现" class="headerlink" title="jDK实现"></a>jDK实现</h3><table>
<thead>
<tr>
<th>算法</th>
<th>密钥长度</th>
<th>默认密钥长度</th>
<th>工作模式</th>
<th>填充方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>RSA</td>
<td>512~65536 <br>(<code>必须64的倍数</code>)</td>
<td>1024</td>
<td>ECB</td>
<td>NoPadding(常用)、<br>PKCS1Padding(常用)、<br>OAEPWITHMD5AndMGF1Padding</td>
</tr>
</tbody>
</table>
<ul>
<li><code>公钥加密私钥解密</code>–主要用来加密</li>
<li><code>私钥加密公钥解密</code>–主要用来数字签名</li>
</ul>
<h2 id="密钥生成步骤"><a href="#密钥生成步骤" class="headerlink" title="密钥生成步骤"></a>密钥生成步骤</h2><p><img src="http://image.beekka.com/blog/201307/bg2013070302.png" alt="image"></p>
<blockquote>
<p><strong>第一步，随机选择两个不相等的质数p和q。</strong></p>
</blockquote>
<ul>
<li>爱丽丝选择了61和53。（实际应用中，这两个质数越大，就越难破解。）</li>
</ul>
<hr>
<blockquote>
<p>第二步，计算p和q的乘积n。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">n = 61×53 = 3233</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>第三步，计算n的欧拉函数φ(n)。</p>
</blockquote>
<ul>
<li>根据公式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">　φ(n) = (p-1)(q-1)</div></pre></td></tr></table></figure>
<ul>
<li>爱丽丝算出φ(3233)等于60×52，即3120。</li>
</ul>
<hr>
<blockquote>
<p>第四步，随机选择一个整数e，条件是1&lt; e &lt; φ(n)，且e与φ(n) 互质。</p>
</blockquote>
<ul>
<li>爱丽丝就在1到3120之间，随机选择了17。（实际应用中，常常选择65537。）</li>
</ul>
<hr>
<blockquote>
<p>第五步，计算e对于φ(n)的模反元素d。</p>
</blockquote>
<ul>
<li>所谓”模反元素”就是指有一个整数d，可以使得ed被φ(n)除的余数为1。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ed ≡ 1 (mod φ(n))</div></pre></td></tr></table></figure>
<ul>
<li>这个式子等价于</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">　ed - 1 = kφ(n)</div></pre></td></tr></table></figure>
<ul>
<li>于是，找到模反元素d，实质上就是对下面这个二元一次方程求解。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">　ex + φ(n)y = 1</div></pre></td></tr></table></figure>
<ul>
<li>已知 e=17, φ(n)=3120</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">17x + 3120y = 1</div></pre></td></tr></table></figure>
<ul>
<li>这个方程可以用”扩展欧几里得算法”求解，此处省略具体过程。总之，爱丽丝算出一组整数解为 (x,y)=(2753,-15)，即 d=2753。</li>
</ul>
<hr>
<blockquote>
<p>第六步，将n和e封装成公钥，n和d封装成私钥。</p>
</blockquote>
<ul>
<li>在爱丽丝的例子中，n=3233，e=17，d=2753，所以公钥就是 (3233,17)，私钥就是（3233, 2753）。<br>实际应用中，公钥和私钥的数据都采用ASN.1格式表达（实例）。</li>
</ul>
<hr>
<blockquote>
<p>七、RSA算法的可靠性</p>
</blockquote>
<ul>
<li>回顾上面的密钥生成步骤，一共出现六个数字：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">p</div><div class="line">q</div><div class="line">n</div><div class="line">φ(n)</div><div class="line">e</div><div class="line">d</div></pre></td></tr></table></figure>
<ul>
<li>这六个数字之中，公钥用到了两个（n和e），其余四个数字都是不公开的。其中最关键的是d，因为n和d组成了私钥，一旦d泄漏，就等于私钥泄漏。</li>
</ul>
<blockquote>
<p>八、加密和解密</p>
</blockquote>
<ul>
<li><p>（1）加密要用公钥 (n,e)</p>
<ul>
<li>假设鲍勃要向爱丽丝发送加密信息m，他就要用爱丽丝的公钥 (n,e) 对m进行加密。这里需要注意，m必须是整数（字符串可以取ascii值或unicode值），且m必须小于n。</li>
<li><p>所谓”加密”，就是算出下式的c： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　me ≡ c (mod n)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<pre><code>+ 爱丽丝的公钥是 (3233, 17)，鲍勃的m假设是65，那么可以算出下面的等式：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">6517 ≡ 2790 (mod 3233)</div></pre></td></tr></table></figure>


+ 于是，c等于2790，鲍勃就把2790发给了爱丽丝。
</code></pre><ul>
<li><p>（2）解密要用私钥(n,d)</p>
<ul>
<li><p>爱丽丝拿到鲍勃发来的2790以后，就用自己的私钥(3233, 2753) 进行解密。可以证明，下面的等式一定成立：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　cd ≡ m (mod n)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<pre><code>+ 也就是说，c的d次方除以n的余数为m。现在，c等于2790，私钥是(3233, 2753)，那么，爱丽丝算出

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">27902753 ≡ 65 (mod 3233)</div></pre></td></tr></table></figure>

+ 因此，爱丽丝知道了鲍勃加密前的原文就是65。
</code></pre><hr>
<blockquote>
<p>九、私钥解密的证明</p>
</blockquote>
<ul>
<li><p>最后，我们来证明，为什么用私钥解密，一定可以正确地得到m。也就是证明下面这个式子：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　cd ≡ m (mod n)</div></pre></td></tr></table></figure>
<ul>
<li><p>因为，根据加密规则
　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　ｍe ≡ c (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>于是，c可以写成下面的形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　c = me - kn</div></pre></td></tr></table></figure>
</li>
<li><p>将c代入要我们要证明的那个解密规则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(me - kn)d ≡ m (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>它等同于求证</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">med ≡ m (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>由于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ed ≡ 1 (mod φ(n))</div></pre></td></tr></table></figure>
</li>
<li><p>所以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ed = hφ(n)+1</div></pre></td></tr></table></figure>
</li>
<li><p>将ed代入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mhφ(n)+1 ≡ m (mod n)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>接下来，分成两种情况证明上面这个式子。</p>
</li>
<li><p>（1）m与n互质。</p>
<ul>
<li><p>根据欧拉定理，此时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　 mφ(n) ≡ 1 (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(mφ(n))h × m ≡ m (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>原式得到证明。</p>
</li>
</ul>
</li>
<li><p>（2）m与n不是互质关系。<br>此时，由于n等于质数p和q的乘积，所以m必然等于kp或kq。<br>以 m = kp为例，考虑到这时k与q必然互质，则根据欧拉定理，下面的式子成立：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(kp)q-1 ≡ 1 (mod q)</div></pre></td></tr></table></figure>
<ul>
<li><p>进一步得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　[(kp)q-1]h(p-1) × kp ≡ kp (mod q)</div></pre></td></tr></table></figure>
</li>
<li><p>即</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　(kp)ed ≡ kp (mod q)</div></pre></td></tr></table></figure>
</li>
<li><p>将它改写成下面的等式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　(kp)ed = tq + kp</div></pre></td></tr></table></figure>
</li>
<li><p>这时t必然能被p整除，即 t=t’p</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　(kp)ed = t&apos;pq + kp</div></pre></td></tr></table></figure>
</li>
<li><p>因为 m=kp，n=pq，所以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　med ≡ m (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>原式得到证明。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">package rsa;</div><div class="line"></div><div class="line">/*</div><div class="line">* --------------------------------------------**********--------------------------------------------</div><div class="line">*</div><div class="line">* 该算法于1977年由美国麻省理工学院MIT(Massachusetts Institute of Technology)的Ronal Rivest，Adi Shamir和Len Adleman三位年轻教授提出，并以三人的姓氏Rivest，Shamir和Adlernan命名为RSA算法，是一个支持变长密钥的公共密钥算法，需要加密的文件快的长度也是可变的!</div><div class="line">*</div><div class="line"> *所谓RSA加密算法，是世界上第一个非对称加密算法，也是数论的第一个实际应用。它的算法如下：</div><div class="line">*</div><div class="line"> 1.找两个非常大的质数p和q（通常p和q都有155十进制位或都有512十进制位）并计算n=pq，k=(p-1)(q-1)。</div><div class="line"></div><div class="line"> 2.将明文编码成整数M，保证M不小于0但是小于n。</div><div class="line"></div><div class="line"> 3.任取一个整数e，保证e和k互质，而且e不小于0但是小于k。加密钥匙（称作公钥）是(e, n)。 【exponent】</div><div class="line"></div><div class="line"> 4.找到一个整数d，使得ed除以k的余数是1（只要e和n满足上面条件，d肯定存在）。解密钥匙（称作密钥）是(d, n)。</div><div class="line"></div><div class="line"> 加密过程： 加密后的编码C等于M的e次方除以n所得的余数。</div><div class="line"></div><div class="line"> 解密过程： 解密后的编码N等于C的d次方除以n所得的余数。</div><div class="line"></div><div class="line"> 只要e、d和n满足上面给定的条件。M等于N。</div><div class="line"></div><div class="line"></div><div class="line"> --------------------------------------------**********--------------------------------------------</div><div class="line"> */</div><div class="line"></div><div class="line">import javax.crypto.BadPaddingException;</div><div class="line">import javax.crypto.Cipher;</div><div class="line">import javax.crypto.IllegalBlockSizeException;</div><div class="line">import javax.crypto.NoSuchPaddingException;</div><div class="line">import java.math.BigInteger;</div><div class="line">import java.security.*;</div><div class="line">import java.security.interfaces.RSAPrivateKey;</div><div class="line">import java.security.interfaces.RSAPublicKey;</div><div class="line">import java.security.spec.InvalidKeySpecException;</div><div class="line">import java.security.spec.RSAPrivateKeySpec;</div><div class="line">import java.security.spec.RSAPublicKeySpec;</div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.Map;</div><div class="line">http://my.oschina.net/ousinka/blog/338099</div><div class="line"></div><div class="line">## 加密算法</div><div class="line">    </div><div class="line">### 对称加密算法</div><div class="line">+ (1) 甲方选择某一种加密规则，对信息进行加密；　　</div><div class="line">+ (2) 乙方使用同一种规则，对信息进行解密。 </div><div class="line">+ (3) 加密和解秘使用同一种规则，对信息进行解谜</div><div class="line"></div><div class="line">&gt; 这种加密模式有一个最大弱点：甲方必须把加密规则告诉乙方，否则无法解密。保存和传递密钥，就成了最头疼的问题。    </div><div class="line"></div><div class="line">### 非对称加密算法</div><div class="line"></div><div class="line">+ (1)乙方生成两把密钥（公钥和私钥）。公钥是公开的，任何人都可以获得，私钥则是保密的。</div><div class="line">+ (2) 甲方获取乙方的公钥，然后用它对信息加密。</div><div class="line">+ (3) 乙方得到加密后的信息，用私钥解密。</div><div class="line"> </div><div class="line">&gt; 如果公钥加密的信息只有私钥解得开，那么只要私钥不泄漏，通信就是安全的。</div><div class="line"></div><div class="line">+ 三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，这种算法用他门三个人的名字命名，叫做RSA算法。</div><div class="line"></div><div class="line">### 你需要知道的数论知识</div><div class="line"></div><div class="line">+ (1) 互质关系</div><div class="line">    + 如果两个正整数，除了1以外，没有其他公因子，我们就称这两个数是互质关系（coprime）。</div><div class="line">+ (2) 欧拉函数</div><div class="line">+ (3) 欧拉定理</div><div class="line">    + 如果两个正整数a和n互质，则n的欧拉函数 φ(n)可以让下面的等式成立：</div><div class="line">    + ![image](http://chart.googleapis.com/chart?cht=tx&amp;chl=a%5E%7B%5Cphi(n)%7D%5Cequiv%5C1%20(mod%5C%20n)&amp;chs=60)</div><div class="line">+ 模反元素</div><div class="line">    + 如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1被n整除，或者说ab被n除的余数是1。</div><div class="line">    + ![image](http://chart.googleapis.com/chart?cht=tx&amp;chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n)&amp;chs=40)</div><div class="line">    + 这时，b就叫做a的&quot;模反元素&quot;。</div><div class="line"></div><div class="line">### 欧拉函数</div><div class="line"></div><div class="line">+ 任意给定正整数`n`，请问在小于等于`n`的正整数之中，有多少个数与`n`构成互质关系，计算这个值的方法叫做`欧拉函数`</div><div class="line">+ 以`φ(n)`表示。</div><div class="line">    + 在1到8之中，与8形成互质关系的是1、3、5、7，所以 `φ(8) = 4`。</div><div class="line"></div><div class="line">------------------------------------------------------------------------</div><div class="line"></div><div class="line">+ `第一种情况:如果是1`</div><div class="line">    +  如果`n=1`，则 `φ(1) = 1` 。因为1与任何数（包括自身）都构成互质关系。</div><div class="line"></div><div class="line">------------------------------------------------------------------------</div><div class="line"></div><div class="line">+ `第二种情况：如果是质数`</div><div class="line">    +  如果`n`是质数，则 `φ(n)=n-1`。</div><div class="line">    +  因为质数与小于它的每一个数，都构成互质关系。比如`5`与`1`、`2`、`3`、`4`都构成互质关系。</div><div class="line"></div><div class="line">------------------------------------------------------------------------</div><div class="line"></div><div class="line">+ `第三种情况:如果是质数的某一个次方`</div><div class="line">    +  如果`n`是质数的某一个次方，即 `n = p^k`（`p`为质数，`k`为大于等于1的整数），则</div><div class="line">    +  ![image](http://chart.googleapis.com/chart?cht=tx&amp;chl=%5Cphi(p%5E%7Bk%7D)%3Dp%5E%7Bk%7D-p%5E%7Bk-1%7D&amp;chs=40)</div><div class="line">    +  比如 φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4。</div><div class="line">    +  这是因为只有当一个数不包含质数`p`，才可能与n互质。而包含质数`p`的数一共有`p^(k-1)`个，即1×p、2×p、3×p、...、p^(k-1)×p，把它们去除，剩下的就是与`n`互质的数。</div><div class="line"></div><div class="line">------------------------------------------------------------------------</div><div class="line"></div><div class="line">+ `第四种情况：如果n可以分解成两个互质的整数之积`</div><div class="line">    </div><div class="line">    + 如果n可以分解成两个互质的整数之积</div></pre></td></tr></table></figure>
<pre><code>　　n = p1 × p2
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 则</div></pre></td></tr></table></figure>

　φ(n) = φ(p1p2) = φ(p1)φ(p2)

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">    + 积的欧拉函数等于各个因子的欧拉函数之积。比如，φ(56)=φ(8×7)=φ(8)×φ(7)=4×6=24。</div><div class="line">    </div><div class="line">### 模反元素</div><div class="line"></div><div class="line">+ 如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1 被n整除，或者说ab被n除的余数是1，也就是` ab / n = 1`</div><div class="line">+ ![image](http://chart.googleapis.com/chart?cht=tx&amp;chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n)&amp;chs=40)</div><div class="line">+ 欧拉定理可以用来证明模反元素必然存在。</div><div class="line">+ ![image](http://chart.googleapis.com/chart?cht=tx&amp;chl=a%5E%7B%5Cphi(n)%7D%3Da%5Ctimes%20a%5E%7B%5Cphi(n)-1%7D%5Cequiv%5C%201%5C%20(mod%5C%20n)%20&amp;chs=40)</div><div class="line">+ 可以看到，a的 φ(n)-1 次方，就是a的模反元素。</div><div class="line">+ 比如，3和11互质，那么3的模反元素就是4，因为 (3 × 4)-1 可以被11整除。显然，模反元素不止一个， 4加减11的整数倍都是3的模反元素 &#123;...,-18,-7,4,15,26,...&#125;，即如果b是a的模反元素，则 b+kn 都是a的模反元素。</div><div class="line">+ 欧拉定理可以用来证明模反元素必然存在。</div><div class="line"></div><div class="line">### RSA数学原理</div><div class="line"></div><div class="line">+ RSA加密 密文 = 明文e次方 Mod (就是%取余的意思) N 公钥 （e,N）  </div><div class="line">+ RSA解密 明文 = 密文d次方 Mod (就是%取余的意思) N 私钥 （d,N） </div><div class="line"></div><div class="line"></div><div class="line">### jDK实现</div><div class="line"></div><div class="line">|算法|密钥长度|默认密钥长度|工作模式|填充方式|</div><div class="line">|----|----|----|----|----|</div><div class="line">|RSA|512~65536 &lt;/br&gt;(`必须64的倍数`)|1024|ECB|NoPadding(常用)、&lt;/br&gt;PKCS1Padding(常用)、&lt;/br&gt;OAEPWITHMD5AndMGF1Padding|</div><div class="line"></div><div class="line">+ `公钥加密私钥解密`--主要用来加密</div><div class="line">+ `私钥加密公钥解密`--主要用来数字签名</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">## 密钥生成步骤</div><div class="line"></div><div class="line">![image](http://image.beekka.com/blog/201307/bg2013070302.png)</div><div class="line"></div><div class="line">&gt; **第一步，随机选择两个不相等的质数p和q。**</div><div class="line"></div><div class="line">+ 爱丽丝选择了61和53。（实际应用中，这两个质数越大，就越难破解。）</div><div class="line"></div><div class="line">----</div><div class="line"></div><div class="line">&gt; 第二步，计算p和q的乘积n。</div></pre></td></tr></table></figure>

    n = 61×53 = 3233
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line">-----</div><div class="line"> </div><div class="line">&gt; 第三步，计算n的欧拉函数φ(n)。</div><div class="line">    </div><div class="line">+ 根据公式</div></pre></td></tr></table></figure>
<p>　φ(n) = (p-1)(q-1)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 爱丽丝算出φ(3233)等于60×52，即3120。</div><div class="line"></div><div class="line">----</div><div class="line"></div><div class="line">&gt; 第四步，随机选择一个整数e，条件是1&lt; e &lt; φ(n)，且e与φ(n) 互质。</div><div class="line"></div><div class="line">+ 爱丽丝就在1到3120之间，随机选择了17。（实际应用中，常常选择65537。）</div><div class="line"></div><div class="line">----</div><div class="line"></div><div class="line">&gt; 第五步，计算e对于φ(n)的模反元素d。</div><div class="line"></div><div class="line">+ 所谓&quot;模反元素&quot;就是指有一个整数d，可以使得ed被φ(n)除的余数为1。</div></pre></td></tr></table></figure>
<p>ed ≡ 1 (mod φ(n))</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 这个式子等价于</div></pre></td></tr></table></figure>
<p>　ed - 1 = kφ(n)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 于是，找到模反元素d，实质上就是对下面这个二元一次方程求解。</div></pre></td></tr></table></figure>
<p>　ex + φ(n)y = 1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 已知 e=17, φ(n)=3120</div></pre></td></tr></table></figure>
<p>17x + 3120y = 1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 这个方程可以用&quot;扩展欧几里得算法&quot;求解，此处省略具体过程。总之，爱丽丝算出一组整数解为 (x,y)=(2753,-15)，即 d=2753。</div><div class="line"></div><div class="line">----</div><div class="line"></div><div class="line">&gt; 第六步，将n和e封装成公钥，n和d封装成私钥。</div><div class="line"></div><div class="line">+ 在爱丽丝的例子中，n=3233，e=17，d=2753，所以公钥就是 (3233,17)，私钥就是（3233, 2753）。</div><div class="line">实际应用中，公钥和私钥的数据都采用ASN.1格式表达（实例）。</div><div class="line"></div><div class="line">----</div><div class="line"></div><div class="line">&gt; 七、RSA算法的可靠性</div><div class="line"></div><div class="line">+ 回顾上面的密钥生成步骤，一共出现六个数字：</div></pre></td></tr></table></figure>
<p>p<br>q<br>n<br>φ(n)<br>e<br>d</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 这六个数字之中，公钥用到了两个（n和e），其余四个数字都是不公开的。其中最关键的是d，因为n和d组成了私钥，一旦d泄漏，就等于私钥泄漏。</div><div class="line"></div><div class="line">&gt; 八、加密和解密</div><div class="line"></div><div class="line">+ （1）加密要用公钥 (n,e)</div><div class="line">    + 假设鲍勃要向爱丽丝发送加密信息m，他就要用爱丽丝的公钥 (n,e) 对m进行加密。这里需要注意，m必须是整数（字符串可以取ascii值或unicode值），且m必须小于n。</div><div class="line">    + 所谓&quot;加密&quot;，就是算出下式的c：</div></pre></td></tr></table></figure>
<pre><code>　　me ≡ c (mod n)

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 爱丽丝的公钥是 (3233, 17)，鲍勃的m假设是65，那么可以算出下面的等式：</div></pre></td></tr></table></figure>

6517 ≡ 2790 (mod 3233)

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">    </div><div class="line">    + 于是，c等于2790，鲍勃就把2790发给了爱丽丝。</div><div class="line"></div><div class="line">+ （2）解密要用私钥(n,d)</div><div class="line">    + 爱丽丝拿到鲍勃发来的2790以后，就用自己的私钥(3233, 2753) 进行解密。可以证明，下面的等式一定成立：</div></pre></td></tr></table></figure>

　cd ≡ m (mod n)

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 也就是说，c的d次方除以n的余数为m。现在，c等于2790，私钥是(3233, 2753)，那么，爱丽丝算出</div></pre></td></tr></table></figure>

27902753 ≡ 65 (mod 3233)

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">    + 因此，爱丽丝知道了鲍勃加密前的原文就是65。</div><div class="line"></div><div class="line">----</div><div class="line"></div><div class="line">&gt; 九、私钥解密的证明</div><div class="line"></div><div class="line">+ 最后，我们来证明，为什么用私钥解密，一定可以正确地得到m。也就是证明下面这个式子：</div></pre></td></tr></table></figure>

　　cd ≡ m (mod n)
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 因为，根据加密规则</div></pre></td></tr></table></figure>

　　ｍe ≡ c (mod n)
　　
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 于是，c可以写成下面的形式：</div></pre></td></tr></table></figure>

　　c = me - kn
　　
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 将c代入要我们要证明的那个解密规则：</div></pre></td></tr></table></figure>

    (me - kn)d ≡ m (mod n)

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 它等同于求证</div><div class="line"></div><div class="line">```　</div><div class="line">med ≡ m (mod n)</div></pre></td></tr></table></figure>

+ 由于

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ed ≡ 1 (mod φ(n))</div></pre></td></tr></table></figure>

+ 所以

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ed = hφ(n)+1</div></pre></td></tr></table></figure>

+ 将ed代入：

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mhφ(n)+1 ≡ m (mod n)</div></pre></td></tr></table></figure>
</code></pre><ul>
<li>接下来，分成两种情况证明上面这个式子。</li>
<li><p>（1）m与n互质。</p>
<ul>
<li><p>根据欧拉定理，此时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　 mφ(n) ≡ 1 (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(mφ(n))h × m ≡ m (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>原式得到证明。</p>
</li>
</ul>
</li>
<li><p>（2）m与n不是互质关系。<br>此时，由于n等于质数p和q的乘积，所以m必然等于kp或kq。<br>以 m = kp为例，考虑到这时k与q必然互质，则根据欧拉定理，下面的式子成立：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(kp)q-1 ≡ 1 (mod q)</div></pre></td></tr></table></figure>
<ul>
<li><p>进一步得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　[(kp)q-1]h(p-1) × kp ≡ kp (mod q)</div></pre></td></tr></table></figure>
</li>
<li><p>即</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　(kp)ed ≡ kp (mod q)</div></pre></td></tr></table></figure>
</li>
<li><p>将它改写成下面的等式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　(kp)ed = tq + kp</div></pre></td></tr></table></figure>
</li>
<li><p>这时t必然能被p整除，即 t=t’p</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　　(kp)ed = t&apos;pq + kp</div></pre></td></tr></table></figure>
</li>
<li><p>因为 m=kp，n=pq，所以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    　med ≡ m (mod n)</div></pre></td></tr></table></figure>
</li>
<li><p>原式得到证明。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">package rsa;</div><div class="line"></div><div class="line">/*</div><div class="line">* --------------------------------------------**********--------------------------------------------</div><div class="line">*</div><div class="line">* 该算法于1977年由美国麻省理工学院MIT(Massachusetts Institute of Technology)的Ronal Rivest，Adi Shamir和Len Adleman三位年轻教授提出，并以三人的姓氏Rivest，Shamir和Adlernan命名为RSA算法，是一个支持变长密钥的公共密钥算法，需要加密的文件快的长度也是可变的!</div><div class="line">*</div><div class="line"> *所谓RSA加密算法，是世界上第一个非对称加密算法，也是数论的第一个实际应用。它的算法如下：</div><div class="line">*</div><div class="line"> 1.找两个非常大的质数p和q（通常p和q都有155十进制位或都有512十进制位）并计算n=pq，k=(p-1)(q-1)。</div><div class="line"></div><div class="line"> 2.将明文编码成整数M，保证M不小于0但是小于n。</div><div class="line"></div><div class="line"> 3.任取一个整数e，保证e和k互质，而且e不小于0但是小于k。加密钥匙（称作公钥）是(e, n)。 【exponent】</div><div class="line"></div><div class="line"> 4.找到一个整数d，使得ed除以k的余数是1（只要e和n满足上面条件，d肯定存在）。解密钥匙（称作密钥）是(d, n)。</div><div class="line"></div><div class="line"> 加密过程： 加密后的编码C等于M的e次方除以n所得的余数。</div><div class="line"></div><div class="line"> 解密过程： 解密后的编码N等于C的d次方除以n所得的余数。</div><div class="line"></div><div class="line"> 只要e、d和n满足上面给定的条件。M等于N。</div></pre></td></tr></table></figure>
<h3 id="过程中遇到的问题总结"><a href="#过程中遇到的问题总结" class="headerlink" title="过程中遇到的问题总结"></a>过程中遇到的问题总结</h3><ul>
<li>加密后的数据需要用Base64将bytes转换成字符串不然会乱码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">byte[] bytes = RSA.encryptByPrivateKey(b, privateKeyStr);</div><div class="line">        String s2 = Base64Util.encode2String(bytes);</div><div class="line">        String s = new String(bytes);</div><div class="line">        System.out.println(&quot;私钥加密的数据&quot; + s2);</div></pre></td></tr></table></figure>
<ul>
<li>解密后的数据不需要用Base64将bytes转换成字符串，直接<code>new String(bytes)</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">byte[] bytes1 = RSA.decryptByPublicKey(bytes, publicKeyStr);</div><div class="line">        String s1 = new String(bytes1);</div><div class="line">        System.out.println(&quot;公钥解密的数据&quot; + s1);</div></pre></td></tr></table></figure>
<hr>
<ul>
<li>RSAUtil.java</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">package rsa;</div><div class="line"></div><div class="line">import javax.crypto.BadPaddingException;</div><div class="line">import javax.crypto.Cipher;</div><div class="line">import javax.crypto.IllegalBlockSizeException;</div><div class="line">import javax.crypto.NoSuchPaddingException;</div><div class="line">import java.security.*;</div><div class="line">import java.security.interfaces.RSAPrivateKey;</div><div class="line">import java.security.interfaces.RSAPublicKey;</div><div class="line">import java.security.spec.InvalidKeySpecException;</div><div class="line">import java.security.spec.PKCS8EncodedKeySpec;</div><div class="line">import java.security.spec.X509EncodedKeySpec;</div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.Map;</div><div class="line"></div><div class="line">/**</div><div class="line"> * @author by benny on 2016/7/23.</div><div class="line"> * @version 1.0</div><div class="line"> * @description 加密解密签名工具类 使用RSA算法</div><div class="line"> */</div><div class="line">public class RSAUtil &#123;</div><div class="line"></div><div class="line">    //算法类型</div><div class="line">    private static final String KEY_ALGORITHM = &quot;RSA&quot;;</div><div class="line">    //钥匙的长度</div><div class="line">    private static final int KEY_SIZE = 1024;</div><div class="line">    //RSA公钥</div><div class="line">    private static final String PUBLIC_KEY = &quot;RSAPublicKey&quot;;</div><div class="line">    //RSA私钥</div><div class="line">    private static final String PRIVATE_KEY = &quot;RSAPrivateKey&quot;;</div><div class="line">    //签名算法类型</div><div class="line">    private static String SIGN_ALGORITHM = &quot;SHA1WithRSA&quot;;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 初始化密钥</div><div class="line">     */</div><div class="line">    public static Map&lt;String, Object&gt; initKeyPair() &#123;</div><div class="line">        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</div><div class="line">        try &#123;</div><div class="line">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(KEY_ALGORITHM);</div><div class="line">            keyPairGenerator.initialize(KEY_SIZE);</div><div class="line">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</div><div class="line">            //公钥</div><div class="line">            RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();</div><div class="line">            //私钥</div><div class="line">            RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();</div><div class="line">            map.put(PUBLIC_KEY, publicKey);</div><div class="line">            map.put(PRIVATE_KEY, privateKey);</div><div class="line">        &#125; catch (NoSuchAlgorithmException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return map;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 获得公钥</div><div class="line">     *</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    public static RSAPublicKey getPublicKey(Map&lt;String, Object&gt; keyMap) &#123;</div><div class="line"></div><div class="line">        return (RSAPublicKey) initKeyPair().get(PUBLIC_KEY);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 获得公钥</div><div class="line">     *</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    public static RSAPrivateKey getPrivateKey() &#123;</div><div class="line">        return (RSAPrivateKey) initKeyPair().get(PRIVATE_KEY);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 取得公钥，并转化为String类型</div><div class="line">     * @param keyMap</div><div class="line">     * @return 公钥</div><div class="line">     */</div><div class="line">    public static String getPublicKeyStr(Map&lt;String, Object&gt; keyMap) &#123;</div><div class="line">        Key publicKey = (Key) keyMap.get(PUBLIC_KEY);</div><div class="line">        return Base64Util.encode2String(publicKey.getEncoded());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 取得私钥，并转化为String类型</div><div class="line">     * @param keyMap</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    public static String getPrivateKeyStr(Map&lt;String, Object&gt; keyMap) &#123;</div><div class="line">        Key privateKey = (Key) keyMap.get(PRIVATE_KEY);</div><div class="line">        return Base64Util.encode2String(privateKey.getEncoded());</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    /**</div><div class="line">     * 用公钥加密</div><div class="line">     * @param bytes	加密数据</div><div class="line">     * @param publicKeyStr	密钥</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    public static byte[] encryptByPublicKey(byte[] bytes, String publicKeyStr) &#123;</div><div class="line">        //对公钥解密</div><div class="line">        byte[] publicKeyBytes = Base64Util.decodeString2Base64(publicKeyStr);</div><div class="line">        byte[] result = new byte[0];</div><div class="line">        try &#123;</div><div class="line">            // 根据字节数组取得公钥</div><div class="line">            X509EncodedKeySpec x509EncodedKeySpec = new X509EncodedKeySpec(publicKeyBytes);</div><div class="line">            KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</div><div class="line">            Key publicKey = keyFactory.generatePublic(x509EncodedKeySpec);</div><div class="line">            //对数据加密</div><div class="line">            Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</div><div class="line">            cipher.init(Cipher.ENCRYPT_MODE, publicKey);</div><div class="line">            //加密后的byte数组</div><div class="line">            result = cipher.doFinal(bytes);</div><div class="line">        &#125; catch (NoSuchAlgorithmException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeySpecException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (NoSuchPaddingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeyException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (BadPaddingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (IllegalBlockSizeException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 用私钥加密</div><div class="line">     * @param bytes	加密数据</div><div class="line">     * @param privateKeyStr	密钥</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    public static byte[] encryptByPrivateKey(byte[] bytes, String privateKeyStr) &#123;</div><div class="line">        //对私钥解密</div><div class="line">        byte[] privateKeyBytes = Base64Util.decodeString2Base64(privateKeyStr);</div><div class="line">        byte[] result = new byte[0];</div><div class="line">        try &#123;</div><div class="line">            // 取得私钥</div><div class="line">            PKCS8EncodedKeySpec pkcs8EncodedKeySpec = new PKCS8EncodedKeySpec(privateKeyBytes);</div><div class="line">            KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</div><div class="line">            Key privateKey = keyFactory.generatePrivate(pkcs8EncodedKeySpec);</div><div class="line">            // 对数据加密</div><div class="line">            Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</div><div class="line">            cipher.init(Cipher.ENCRYPT_MODE, privateKey);</div><div class="line">            result = cipher.doFinal(bytes);</div><div class="line">        &#125; catch (NoSuchAlgorithmException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeySpecException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (NoSuchPaddingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeyException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (BadPaddingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (IllegalBlockSizeException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 用公钥解密</div><div class="line">     * @param bytes	加密数据</div><div class="line">     * @param publicKeyStr	私钥</div><div class="line">     * @return</div><div class="line">     * @throws Exception</div><div class="line">     */</div><div class="line">    public static byte[] decryptByPublicKey(byte[] bytes, String publicKeyStr) &#123;</div><div class="line">        //对公钥解密</div><div class="line">        byte[] publicKeyBytes = Base64Util.decodeString2Base64(publicKeyStr);</div><div class="line">        byte[] result = new byte[0];</div><div class="line">        try &#123;</div><div class="line">            //取得公钥</div><div class="line">            X509EncodedKeySpec x509EncodedKeySpec = new X509EncodedKeySpec(publicKeyBytes);</div><div class="line">            KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</div><div class="line">            Key publicKey = keyFactory.generatePublic(x509EncodedKeySpec);</div><div class="line"></div><div class="line">            //用公钥解密</div><div class="line">            Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</div><div class="line">            cipher.init(Cipher.DECRYPT_MODE, publicKey);</div><div class="line">            result = cipher.doFinal(bytes);</div><div class="line">        &#125; catch (NoSuchAlgorithmException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeySpecException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (NoSuchPaddingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeyException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (BadPaddingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (IllegalBlockSizeException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 用私钥解密</div><div class="line">     */</div><div class="line">    public static byte[] decryptByPrivateKey(byte[] bytes, String privateKeyStr) &#123;</div><div class="line">        //对私钥解密</div><div class="line">        byte[] privateKeyBytes = Base64Util.decodeString2Base64(privateKeyStr);</div><div class="line">        byte[] result = new byte[0];</div><div class="line">        try &#123;</div><div class="line">            //根据字节数组获得私钥</div><div class="line">            PKCS8EncodedKeySpec pkcs8EncodedKeySpec = new PKCS8EncodedKeySpec(privateKeyBytes);</div><div class="line"></div><div class="line">            KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</div><div class="line">            Key privateKey = keyFactory.generatePrivate(pkcs8EncodedKeySpec);</div><div class="line">            //解密数据</div><div class="line">            Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</div><div class="line">            cipher.init(Cipher.DECRYPT_MODE, privateKey);</div><div class="line">            //解密后的byte数组</div><div class="line">            result = cipher.doFinal(bytes);</div><div class="line">        &#125; catch (NoSuchAlgorithmException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeySpecException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (NoSuchPaddingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeyException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (BadPaddingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (IllegalBlockSizeException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * RSA签名</div><div class="line">     *</div><div class="line">     * @param bytes         待签名数据</div><div class="line">     * @param privateKeyStr 商户私钥</div><div class="line">     * @return 签名值</div><div class="line">     */</div><div class="line">    public static String signByPrivateKey(byte[] bytes, String privateKeyStr) &#123;</div><div class="line">        //base64解密私钥</div><div class="line">        byte[] privateKeyBytes = Base64Util.decodeString2Base64(privateKeyStr);</div><div class="line">        String result = &quot;&quot;;</div><div class="line">        try &#123;</div><div class="line">            //取得私钥</div><div class="line">            PKCS8EncodedKeySpec pkcs8EncodedKeySpec = new PKCS8EncodedKeySpec(privateKeyBytes);</div><div class="line">            //指定加密算法</div><div class="line">            KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</div><div class="line">            PrivateKey privateKey = keyFactory.generatePrivate(pkcs8EncodedKeySpec);</div><div class="line">            //用私钥对信息生成数字签名</div><div class="line">            Signature signature = Signature.getInstance(SIGN_ALGORITHM);</div><div class="line">            signature.initSign(privateKey);</div><div class="line">            signature.update(bytes);</div><div class="line">            result = Base64Util.encode2String(signature.sign());</div><div class="line">        &#125; catch (NoSuchAlgorithmException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeySpecException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeyException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (SignatureException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * RSA签名验证</div><div class="line">     *</div><div class="line">     * @param bytes        待签名数据</div><div class="line">     * @param signByte         签名值</div><div class="line">     * @param publicKeyStr 分配给开发商公钥</div><div class="line">     * @return 布尔值</div><div class="line">     */</div><div class="line">    public static boolean checkSignature(byte[] bytes, byte[] signByte, String publicKeyStr) &#123;</div><div class="line">        //base64解密公钥</div><div class="line">        byte[] publicKeyBytes = Base64Util.decodeString2Base64(publicKeyStr);</div><div class="line">        boolean result = false;</div><div class="line">        try &#123;</div><div class="line">            //构造X509EncodedKeySpec对象</div><div class="line">            X509EncodedKeySpec x509EncodedKeySpec = new X509EncodedKeySpec(publicKeyBytes);</div><div class="line">            //指定加密算法</div><div class="line">            KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);</div><div class="line">            //取公钥匙对象</div><div class="line">            PublicKey publicKey = keyFactory.generatePublic(x509EncodedKeySpec);</div><div class="line">            Signature signature = Signature.getInstance(SIGN_ALGORITHM);</div><div class="line">            signature.initVerify(publicKey);</div><div class="line">            signature.update(bytes);</div><div class="line">            result = signature.verify(signByte);</div><div class="line">        &#125; catch (NoSuchAlgorithmException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeySpecException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (InvalidKeyException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; catch (SignatureException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Base64Util.java</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">package rsa;</div><div class="line"></div><div class="line"></div><div class="line">import sun.misc.BASE64Decoder;</div><div class="line">import sun.misc.BASE64Encoder;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line"></div><div class="line">/**</div><div class="line"> * @author by benny on 2016/7/23.</div><div class="line"> * @version 1.0</div><div class="line"> * @description Base64 编码工具</div><div class="line"> */</div><div class="line">public class Base64Util &#123;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 加密成字符串</div><div class="line">     * @param key</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    public static String encode2String(byte[] key)&#123;</div><div class="line">        return new BASE64Encoder().encode(key);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 解密成字节数组</div><div class="line">     * @param key</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    public static byte[] decodeString2Base64(String key)&#123;</div><div class="line">        byte[] result = new byte[0];</div><div class="line">        try &#123;</div><div class="line">            result =  new BASE64Decoder().decodeBuffer(key);</div><div class="line">        &#125; catch (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="RSAUtil使用说明"><a href="#RSAUtil使用说明" class="headerlink" title="RSAUtil使用说明"></a>RSAUtil使用说明</h2><h3 id="公钥加密-私钥解密"><a href="#公钥加密-私钥解密" class="headerlink" title="公钥加密 私钥解密"></a>公钥加密 私钥解密</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">String resource = &quot;我是加密的数据&quot;;</div><div class="line"></div><div class="line">Map&lt;String, Object&gt; keyMap = RSAUtil.initKeyPair();</div><div class="line"></div><div class="line">&lt;!--获得公钥--&gt;</div><div class="line">String publicKeyStr = RSAUtil.getPublicKeyStr(keyMap);</div><div class="line">&lt;!--获得私钥--&gt;</div><div class="line">String privateKeyStr = RSAUtil.getPrivateKeyStr(keyMap);</div><div class="line"></div><div class="line">&lt;!--将要加密的字符串转成字节数组--&gt;</div><div class="line">byte[] bytes = resource.getBytes();</div><div class="line"></div><div class="line">&lt;!--公钥加密--&gt;</div><div class="line">byte[] encryptBytes = RSAUtil.encryptByPublicKey(bytes, publicKeyStr);</div><div class="line">&lt;!--加密后的字符串--&gt;</div><div class="line">String encryptStr = Base64Util.encode2String(encryptBytes);</div><div class="line"></div><div class="line">&lt;!--私钥解密--&gt;</div><div class="line">byte[] decryptBytes = RSAUtil.decryptByPrivateKey(bytes, privateKeyStr);</div><div class="line">&lt;!--解密后的字符串--&gt;</div><div class="line">String decryptStr = new String(decryptBytes);</div></pre></td></tr></table></figure>
<h3 id="私钥加密-公钥解密-（签名）"><a href="#私钥加密-公钥解密-（签名）" class="headerlink" title="私钥加密 公钥解密 （签名）"></a>私钥加密 公钥解密 （签名）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">String resource = &quot;我是加密的数据&quot;;</div><div class="line"></div><div class="line">Map&lt;String, Object&gt; keyMap = RSAUtil.initKeyPair();</div><div class="line"></div><div class="line">&lt;!--获得公钥--&gt;</div><div class="line">String publicKeyStr = RSAUtil.getPublicKeyStr(keyMap);</div><div class="line">&lt;!--获得私钥--&gt;</div><div class="line">String privateKeyStr = RSAUtil.getPrivateKeyStr(keyMap);</div><div class="line"></div><div class="line">&lt;!--将要加密的字符串转成字节数组--&gt;</div><div class="line">byte[] b = resource.getBytes();</div><div class="line"></div><div class="line">&lt;!--生成签名字符串--&gt;</div><div class="line">String s1 = RSAUtil.signByPrivateKey(b, privateKeyStr);</div><div class="line">   </div><div class="line">&lt;!--验证签名--&gt;</div><div class="line">boolean result = RSAUtil.checkSignature(b12, Base64Util.decodeString2Base64(s1), publicKeyStr);</div><div class="line"></div><div class="line">if true 签名正确  else 签名失败</div></pre></td></tr></table></figure>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2016/07/25/160725_rsa_algorithm/">RSA加密签名</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage">Benny</a></p>
        <p><span>Created:</span>2016-07-25, 09:50:27</p>
        <p><span>Updated:</span>2016-07-25, 09:50:59</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2016/07/25/160725_rsa_algorithm/" title="RSA加密签名">/2016/07/25/160725_rsa_algorithm/</a>
            <span class="copy-path" data-clipboard-text="From /2016/07/25/160725_rsa_algorithm/　　By Benny" title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2016/08/01/160801_sc_arraylist/">
                    ArrayList源码阅读
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2016/07/06/160706_linuxcommand/">
                    关于Linux命令的那点小事
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#加密算法"><span class="toc-number">1.</span> <span class="toc-text">加密算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#对称加密算法"><span class="toc-number">1.1.</span> <span class="toc-text">对称加密算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#非对称加密算法"><span class="toc-number">1.2.</span> <span class="toc-text">非对称加密算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#你需要知道的数论知识"><span class="toc-number">1.3.</span> <span class="toc-text">你需要知道的数论知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#欧拉函数"><span class="toc-number">1.4.</span> <span class="toc-text">欧拉函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模反元素"><span class="toc-number">1.5.</span> <span class="toc-text">模反元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA数学原理"><span class="toc-number">1.6.</span> <span class="toc-text">RSA数学原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jDK实现"><span class="toc-number">1.7.</span> <span class="toc-text">jDK实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#密钥生成步骤"><span class="toc-number">2.</span> <span class="toc-text">密钥生成步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#过程中遇到的问题总结"><span class="toc-number">2.1.</span> <span class="toc-text">过程中遇到的问题总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSAUtil使用说明"><span class="toc-number">3.</span> <span class="toc-text">RSAUtil使用说明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#公钥加密-私钥解密"><span class="toc-number">3.1.</span> <span class="toc-text">公钥加密 私钥解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#私钥加密-公钥解密-（签名）"><span class="toc-number">3.2.</span> <span class="toc-text">私钥加密 公钥解密 （签名）</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">

    <script>
        yiliaConfig.toc = ["Hide", "Show", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"RSA加密签名　| Benny　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section class="youyan" id="comments">
    <script>
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = 'http://v2.uyan.cc/code/uyan.js?uid=2105061';
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

    <div id="uyan_frame"></div>
</section>
    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2016/08/01/160801_sc_arraylist/" title="Pre: ArrayList源码阅读">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2016/07/06/160706_linuxcommand/" title="Next: 关于Linux命令的那点小事">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/08/02/160802_designpatern_read/">设计模式之禅</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/01/160801_sc_arraylist/">ArrayList源码阅读</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/25/160725_rsa_algorithm/">RSA加密签名</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/06/160706_linuxcommand/">关于Linux命令的那点小事</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/05/160705_plantuml/">plantUML的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/03/160703_linuxShellLine/">Linux Shell 命令行及脚本编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/02/160706_clean_code/">代码整洁之道</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/30/160630_jqueryplugin/">jQuery plugin 插件编写时遇到的问题总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/28/160628_first/">博客初搭建</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016 Benny
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>